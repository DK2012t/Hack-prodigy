(SW=SW||{}).LoadIdentity={};var settings={store:window.sessionStorage};SW.LoadIdentity.browserName=null,SW.LoadIdentity.env=null,SW.LoadIdentity.devicePlatform=null,SW.LoadIdentity.DISPLAY_HIDE="none",SW.LoadIdentity.DISPLAY_SHOW="",SW.LoadIdentity.DIV_GAME_LOADING_CONTAINER="game-loading-container-div",SW.LoadIdentity.DIV_ERROR="error-div",SW.LoadIdentity.DIV_LOADING="loading-div",SW.LoadIdentity.DIV_SPLASH_IMAGE="splash-image",SW.LoadIdentity.CSS_ED_PROGRESS_BAR=".ed-progress-bar",SW.LoadIdentity.STORAGE_START_EVENT_TS="startEventTimestamp",SW.LoadIdentity.STORAGE_EVENT_DATA="eventData",SW.LoadIdentity.STORAGE_DEVICE_INFO="device-information",SW.LoadIdentity.ERROR_DESCRIPTION_RELOAD='Try reloading the page.<br>If this message persists, please email our <a href="mailto:support@prodigygame.com" class="text-white"><strong><u>support team</u></strong></a> or visit our <a href="https://twitter.com/prodigygame" class="text-white"><u><strong>status page</strong></u></a> for more details.',SW.LoadIdentity.ERROR_TITLE_DEFAULT="Error Code",SW.LoadIdentity.ERROR_DESCRIPTION_DEFAULT="Oops something went wrong!</br>Try logging in again or come back later.",SW.LoadIdentity.ERROR_TITLE_IDENTITY_REDIRECT_FAILED="Uh oh! We were unable to take you to the login screen.",SW.LoadIdentity.ERROR_DESCRIPTION_IDENTITY_REDIRECT_FAILED=SW.LoadIdentity.ERROR_DESCRIPTION_RELOAD,SW.LoadIdentity.ERROR_TITLE_IDENTITY_CALLBACK_FAILED="Uh oh! We were unable to log you in.",SW.LoadIdentity.ERROR_DESCRIPTION_IDENTITY_CALLBACK_FAILED=SW.LoadIdentity.ERROR_DESCRIPTION_RELOAD,SW.LoadIdentity.ERROR_TITLE_LEGACY_TOKEN_FAILED="Uh oh! We were unable to complete your login.",SW.LoadIdentity.ERROR_DESCRIPTION_LEGACY_TOKEN_FAILED=SW.LoadIdentity.ERROR_DESCRIPTION_RELOAD,SW.LoadIdentity.SENTRY_URL="https://a84188f8494e47ea9adc6469ec4f4deb@sentry.io/1217080",SW.LoadIdentity.SENTRY_SAMPLE_RATE_PROD=.01,SW.LoadIdentity.SENTRY_SAMPLE_RATE_STAGING=.01,SW.LoadIdentity.SENTRY_SAMPLE_RATE_DEFAULT=0;const ENVIRONMENTS={PRODUCTION:"production",STAGING:"staging",DEVELOPMENT:"dev",LOCAL:"local"};SW.LoadIdentity.pendingError=!1,SW.LoadIdentity.pendingErrorTitle="",SW.LoadIdentity.pendingErrorDesc="",SW.LoadIdentity.pendingErrorID=0,SW.LoadIdentity.setDivDisplay=function(e,t){var n=document.getElementById(e);n?n.style.display=t?SW.LoadIdentity.DISPLAY_SHOW:SW.LoadIdentity.DISPLAY_HIDE:console.log(`setDivDisplay div not found: ${e}`)},SW.LoadIdentity.setDivCSS=function(e,t){document.getElementById(e)?style.cssText=t:console.log(`setDivCSS div not found: ${e}`)},SW.LoadIdentity.getUrlVariables=function(e){const t={};return e.replace(/[?&]+([^=&]+)=([^&]*)/gi,(e,n,r)=>t[n]=r),t},SW.LoadIdentity.isAdminLogin=function(){return"admin"===SW.LoadIdentity.getUrlVariables(window.location.href).accessType},SW.LoadIdentity.RedirectToIdentity=function(e,t,n,r){var o=SW.LoadIdentity.getUrlVariables(window.location.href),i=SW.LoadIdentity.getUrlVariables(n),s="",a=-1!==n.indexOf("?")?"&":"?";if(SW.Device.isNativeApp()&&!o.mobilePlatform){o.mobilePlatform=SW.Device.getOS().toLowerCase();const e=window.expoReleaseChannel;e&&e.indexOf("amazon")>-1&&(o.mobilePlatform="amazon")}for(var u of Object.keys(o))i[u]||(s=`${s}${a}${u}=${o[u]}`),"?"===a&&(a="&");var c=`${n}${s}`;SW.LoadIdentity.isAdminLogin()?window.location.href=c:new Oidc.UserManager({userStore:new Oidc.WebStorageStateStore(settings),authority:e,client_id:t,scope:"openid profile email sid",redirect_uri:c,response_type:"id_token token",automaticSilentRenew:!0,prompt:r,extraQueryParams:{mobilePlatform:o.mobilePlatform}}).signinRedirect().catch(e=>{SW.LoadIdentity.setErrorScreen(`Identity signin redirect failed ${e}`,SW.LoadIdentity.ERROR_TITLE_IDENTITY_REDIRECT_FAILED,SW.LoadIdentity.ERROR_DESCRIPTION_IDENTITY_REDIRECT_FAILED,60)})},SW.LoadIdentity.Logout=function(){settings.store.clear()},SW.LoadIdentity.isErrorScreen=function(){var e=SW.LoadIdentity.pending;if(!e){var t=document.getElementById("error-div");t&&(e="none"!==t.style.display)}return e},SW.LoadIdentity.toggleErrorScreen=function(e){SW.LoadIdentity.setDivDisplay(SW.LoadIdentity.DIV_ERROR,e),document.getElementById(SW.LoadIdentity.DIV_LOADING)&&SW.LoadIdentity.setDivDisplay(SW.LoadIdentity.DIV_LOADING,!e),document.getElementById(SW.LoadIdentity.DIV_SPLASH_IMAGE)&&SW.LoadIdentity.setDivDisplay(SW.LoadIdentity.DIV_SPLASH_IMAGE,!e)},SW.LoadIdentity.setErrorScreen=function(e,t,n,r){if(e&&Sentry.captureMessage(`Loader Error: ${e}`),document.getElementById("error-div")){SW.LoadIdentity.toggleErrorScreen(!0);var o=document.getElementById("error-title");o.innerHTML=r?`${SW.LoadIdentity.ERROR_TITLE_DEFAULT}: ${r}`:"Error!",document.getElementById("error-text").innerHTML=SW.LoadIdentity.ERROR_DESCRIPTION_DEFAULT,document.getElementById("try-again-button").onclick=(()=>{location.reload()})}else SW.LoadIdentity.pendingError=!0,SW.LoadIdentity.pendingErrorTitle=t,SW.LoadIdentity.pendingErrorDesc=n,SW.LoadIdentity.pendingErrorID=r},SW.LoadIdentity.checkPendingErrorScreen=function(){SW.LoadIdentity.pendingError&&(SW.LoadIdentity.setErrorScreen(null,SW.LoadIdentity.pendingErrorTitle,SW.LoadIdentity.pendingErrorDesc,SW.LoadIdentity.pendingErrorID),SW.LoadIdentity.pendingError=!1,SW.LoadIdentity.pendingErrorTitle="",SW.LoadIdentity.pendingErrorDesc="",SW.LoadIdentity.pendingErrorID=0)},SW.LoadIdentity.getServiceURL=function(){return prodigyServiceUrl},SW.LoadIdentity.setupEventParams=function(){const e=window.location.host,t=window.location.search;var n="dev";e.indexOf("-qa")>=0||e.indexOf("dev.prodigygame.org")>=0?n=ENVIRONMENTS.LOCAL:e.indexOf("prodigygame.net")>=0||t.indexOf("env=dev")>=0?n=ENVIRONMENTS.DEVELOPMENT:e.indexOf("prodigygame.org")>=0||t.indexOf("env=staging")>=0?n=ENVIRONMENTS.STAGING:(e.indexOf("prodigygame.com")>=0||t.indexOf("env=production")>=0||t.indexOf("env=prod")>=0)&&(n=ENVIRONMENTS.PRODUCTION);var r,o="unknown",i=window.navigator.userAgent;i.indexOf("Opera")>-1||i.indexOf("OPR")>-1?o="Opera":i.indexOf("Chrome")>-1?o="Chrome":i.indexOf("Safari")>-1?o="Safari":i.indexOf("Firefox")>-1?o="Firefox":i.indexOf("SamsungBrowser")>-1?o="Samsung Internet for Android":i.indexOf("Trident")>-1?o="Internet Explorer":i.indexOf("Edge")>-1?o="Microsoft Edge":i.indexOf("Silk")>-1&&(o="Amazon Silk"),r=/iPad|iPhone|iPod/.test(navigator.platform)?/nativeApp/.test(window.location.href)?"iOS-App":"iOS-Browser":/Android/.test(navigator.platform)?/nativeApp/.test(window.location.href)?"Android-App":"Android-Browser":"Desktop-Browser",SW.LoadIdentity.browserName=o,SW.LoadIdentity.env=n,SW.LoadIdentity.devicePlatform=r},SW.LoadIdentity.sendV3Event=function(e,t){const n={name:"anonymous_game_complete_v3",version:3,uuid:window.eventData.uuid,timestamp:Date.now(),timezone_offset:(new Date).getTimezoneOffset(),client_version:SW.LoadIdentity.env,device_platform:SW.LoadIdentity.devicePlatform,browser:SW.LoadIdentity.browserName,meta:t},r=new XMLHttpRequest;r.open("POST",e),r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify({events:JSON.stringify([n])}))},SW.LoadIdentity.sendLoginStart=function(){SW.LoadIdentity.setupEventParams();const e=`${SW.LoadIdentity.getServiceURL()}events-api/v3/anonymous-events`;SW.LoadIdentity.sendV3Event(e,{type:"login_time_funnel",name:"load_start",timeDelta:0})},SW.LoadIdentity.SentryInit=function(e){var t,n=e.env,r=`PGL-${e.version}`;t=n===ENVIRONMENTS.PRODUCTION?SW.LoadIdentity.SENTRY_SAMPLE_RATE_PROD:n===ENVIRONMENTS.STAGING?SW.LoadIdentity.SENTRY_SAMPLE_RATE_STAGING:SW.LoadIdentity.SENTRY_SAMPLE_RATE_DEFAULT,Sentry.init({dsn:SW.LoadIdentity.SENTRY_URL,release:r,environment:n,sampleRate:t,attachStacktrace:!0})},SW.LoadIdentity.uuidv4=function(){const e=window.crypto||window.msCrypto;return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))},SW.LoadIdentity.setTrackingCookie=function(){const e=SW.Cookie.getTrackingCookie()||SW.LoadIdentity.uuidv4();SW.Cookie.setTrackingCookie(e)},SW.LoadIdentity.DisplayVersion=function(){var e=["%c â™¥ Prodigy Loader v"+eventData.version+" â™¥ ","color: #ffffff; background: #fc8cb2"];console.log.apply(console,e)},SW.Cookie={},SW.Cookie._getSecondLevelDomain=(()=>{const e=window.location.host.split(".").slice(-2).join(".");return e.indexOf("localhost")>=0?"localhost":e}),SW.Cookie.get=function(e){return(e=>{const t=`${e}=`,n=document.cookie.split(";");let r,o;for(o=0;o<n.length;o+=1){for(r=n[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null})(`sw.${e}`)},SW.Cookie.set=function(e,t,n,r,o=!1){((e,t,n,r)=>{const o=24*(n||7),i=new Date((new Date).getTime()+60*o*60*1e3);document.cookie=`${e}=${t}${r?`;path=${r}`:""}; expires=${i.toUTCString()}; domain=${SW.Cookie._getSecondLevelDomain()}`})(`sw.${e}`,o?JSON.stringify(t):encodeURIComponent(t),n,r)},SW.Cookie.expire=function(e,t){document.cookie=`sw.${e}=${t?`;path=${t}`:""}; expires=Thu, 01 Jan 1970 00:00:01 GMT;`,document.cookie=`sw.${e}=${t?`;path=${t}`:""}; expires=Thu, 01 Jan 1970 00:00:01 GMT; domain=${SW.Cookie._getSecondLevelDomain()}`},SW.Cookie.setTrackingCookie=(e=>{SW.Cookie.set("track_id",e,730,"/")}),SW.Cookie.getTrackingCookie=(()=>SW.Cookie.get("track_id"));var SW,Oidc=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=62)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o={debug:function(){},info:function(){},warn:function(){},error:function(){}},i=void 0,s=void 0;(t.Log=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.reset=function(){s=3,i=o},e.debug=function(){if(s>=4){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.debug.apply(i,Array.from(t))}},e.info=function(){if(s>=3){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.info.apply(i,Array.from(t))}},e.warn=function(){if(s>=2){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.warn.apply(i,Array.from(t))}},e.error=function(){if(s>=1){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.error.apply(i,Array.from(t))}},r(e,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return s},set:function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");s=e}},{key:"logger",get:function(){return i},set:function(e){if(!e.debug&&e.info&&(e.debug=e.info),!(e.debug&&e.info&&e.warn&&e.error))throw new Error("Invalid logger");i=e}}]),e}()).reset()},function(e,t,n){var r=n(22)("wks"),o=n(24),i=n(2).Symbol,s="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=s&&i[e]||(s?i:o)("Symbol."+e))}).store=r},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.6.4"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o={setInterval:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){return setInterval(e,t)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return clearInterval(e)})},i=!1,s=null;t.Global=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e._testing=function(){i=!0},e.setXMLHttpRequest=function(e){s=e},r(e,null,[{key:"location",get:function(){if(!i)return location}},{key:"localStorage",get:function(){if(!i&&"undefined"!=typeof window)return localStorage}},{key:"sessionStorage",get:function(){if(!i&&"undefined"!=typeof window)return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!i&&"undefined"!=typeof window)return s||XMLHttpRequest}},{key:"timer",get:function(){if(!i)return o}}]),e}()},function(e,t,n){var r=n(6);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(2),o=n(3),i=n(8),s=n(11),a=n(13),u=function(e,t,n){var c,l,p,d,f=e&u.F,h=e&u.G,g=e&u.S,v=e&u.P,_=e&u.B,y=h?r:g?r[t]||(r[t]={}):(r[t]||{}).prototype,m=h?o:o[t]||(o[t]={}),S=m.prototype||(m.prototype={});for(c in h&&(n=t),n)p=((l=!f&&y&&void 0!==y[c])?y:n)[c],d=_&&l?a(p,r):v&&"function"==typeof p?a(Function.call,p):p,y&&s(y,c,p,e&u.U),m[c]!=p&&i(m,c,d),v&&S[c]!=p&&(S[c]=p)};r.core=o,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,n){var r=n(17),o=n(39);e.exports=n(12)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataService=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=n(37);t.MetadataService=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.JsonService;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw o.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=t,this._jsonService=new n(["application/jwk-set+json"])}return e.prototype.getMetadata=function(){var e=this;return this._settings.metadata?(o.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(o.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then(function(t){return o.Log.debug("MetadataService.getMetadata: json received"),e._settings.metadata=t,t})):(o.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},e.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},e.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},e.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},e.prototype.getTokenEndpoint=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)},e.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},e.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},e.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},e.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},e.prototype._getMetadataProperty=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return o.Log.debug("MetadataService.getMetadataProperty for: "+e),this.getMetadata().then(function(n){if(o.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===n[e]){if(!0===t)return void o.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+e);throw o.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+e),new Error("Metadata does not contain property "+e)}return n[e]})},e.prototype.getSigningKeys=function(){var e=this;return this._settings.signingKeys?(o.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then(function(t){return o.Log.debug("MetadataService.getSigningKeys: jwks_uri received",t),e._jsonService.getJson(t).then(function(t){if(o.Log.debug("MetadataService.getSigningKeys: key set received",t),!t.keys)throw o.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return e._settings.signingKeys=t.keys,e._settings.signingKeys})})},r(e,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(".well-known/openid-configuration")<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=".well-known/openid-configuration"))),this._metadataUrl}}]),e}()},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(2),o=n(8),i=n(19),s=n(24)("src"),a=n(68),u=(""+a).split("toString");n(3).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var c="function"==typeof n;c&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(c&&(i(n,s)||o(n,s,e[t]?""+e[t]:u.join(String(t)))),e===r?e[t]=n:a?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(e,t,n){e.exports=!n(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(14);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrlUtility=void 0;var r=n(0),o=n(4);t.UrlUtility=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.addQueryParam=function(e,t,n){return e.indexOf("?")<0&&(e+="?"),"?"!==e[e.length-1]&&(e+="&"),e+=encodeURIComponent(t),(e+="=")+encodeURIComponent(n)},e.parseUrlFragment=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.Global;"string"!=typeof e&&(e=n.location.href);var i=e.lastIndexOf(t);i>=0&&(e=e.substr(i+1)),"?"===t&&(i=e.indexOf("#"))>=0&&(e=e.substr(0,i));for(var s,a={},u=/([^&=]+)=([^&]*)/g,c=0;s=u.exec(e);)if(a[decodeURIComponent(s[1])]=decodeURIComponent(s[2]),c++>50)return r.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",e),{error:"Response exceeded expected number of parameters"};for(var l in a)return a;return{}},e}()},function(e,t,n){var r=n(5),o=n(66),i=n(67),s=Object.defineProperty;t.f=n(12)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JoseUtil=void 0;var r=n(116),o=function(e){return e&&e.__esModule?e:{default:e}}(n(121));t.JoseUtil=(0,o.default)({jws:r.jws,KeyUtil:r.KeyUtil,X509:r.X509,crypto:r.crypto,hextob64u:r.hextob64u,b64tohex:r.b64tohex,AllowedSigningAlgs:r.AllowedSigningAlgs})},function(e,t,n){var r=n(10),o=n(1)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:i?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){var r=n(3),o=n(2),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(23)?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=!1},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(6),o=n(2).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(74),o=n(41);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var r=n(30),o=n(27);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(10);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(26),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(22)("keys"),o=n(24);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(17).f,o=n(19),i=n(1)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(27);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClientSettings=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),s=n(36),a=n(114),u=n(9),c="id_token",l="openid",p=900,d=300;t.OidcClientSettings=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.authority,o=t.metadataUrl,i=t.metadata,f=t.signingKeys,h=t.client_id,g=t.client_secret,v=t.response_type,_=void 0===v?c:v,y=t.scope,m=void 0===y?l:y,S=t.redirect_uri,b=t.post_logout_redirect_uri,w=t.prompt,k=t.display,E=t.max_age,T=t.ui_locales,L=t.acr_values,x=t.resource,R=t.response_mode,I=t.filterProtocolClaims,O=void 0===I||I,P=t.loadUserInfo,C=void 0===P||P,U=t.staleStateAge,j=void 0===U?p:U,M=t.clockSkew,N=void 0===M?d:M,A=t.userInfoJwtIssuer,W=void 0===A?"OP":A,D=t.stateStore,F=void 0===D?new s.WebStorageStateStore:D,q=t.ResponseValidatorCtor,B=void 0===q?a.ResponseValidator:q,V=t.MetadataServiceCtor,J=void 0===V?u.MetadataService:V,H=t.extraQueryParams,G=void 0===H?{}:H,z=t.extraTokenParams,$=void 0===z?{}:z;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._authority=n,this._metadataUrl=o,this._metadata=i,this._signingKeys=f,this._client_id=h,this._client_secret=g,this._response_type=_,this._scope=m,this._redirect_uri=S,this._post_logout_redirect_uri=b,this._prompt=w,this._display=k,this._max_age=E,this._ui_locales=T,this._acr_values=L,this._resource=x,this._response_mode=R,this._filterProtocolClaims=!!O,this._loadUserInfo=!!C,this._staleStateAge=j,this._clockSkew=N,this._userInfoJwtIssuer=W,this._stateStore=F,this._validator=new B(this),this._metadataService=new J(this),this._extraQueryParams="object"===(void 0===G?"undefined":r(G))?G:{},this._extraTokenParams="object"===(void 0===$?"undefined":r($))?$:{}}return o(e,[{key:"client_id",get:function(){return this._client_id},set:function(e){if(this._client_id)throw i.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=e}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(e){if(this._authority)throw i.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=e}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(".well-known/openid-configuration")<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=".well-known/openid-configuration")),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(e){this._metadata=e}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(e){this._signingKeys=e}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(e){"object"===(void 0===e?"undefined":r(e))?this._extraQueryParams=e:this._extraQueryParams={}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(e){"object"===(void 0===e?"undefined":r(e))?this._extraTokenParams=e:this._extraTokenParams={}}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebStorageStateStore=void 0;var r=n(0),o=n(4);t.WebStorageStateStore=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.prefix,r=void 0===n?"oidc.":n,i=t.store,s=void 0===i?o.Global.localStorage:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._store=s,this._prefix=r}return e.prototype.set=function(e,t){return r.Log.debug("WebStorageStateStore.set",e),e=this._prefix+e,this._store.setItem(e,t),Promise.resolve()},e.prototype.get=function(e){r.Log.debug("WebStorageStateStore.get",e),e=this._prefix+e;var t=this._store.getItem(e);return Promise.resolve(t)},e.prototype.remove=function(e){r.Log.debug("WebStorageStateStore.remove",e),e=this._prefix+e;var t=this._store.getItem(e);return this._store.removeItem(e),Promise.resolve(t)},e.prototype.getAllKeys=function(){r.Log.debug("WebStorageStateStore.getAllKeys");for(var e=[],t=0;t<this._store.length;t++){var n=this._store.key(t);0===n.indexOf(this._prefix)&&e.push(n.substr(this._prefix.length))}return Promise.resolve(e)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonService=void 0;var r=n(0),o=n(4);t.JsonService=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Global.XMLHttpRequest,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&Array.isArray(t)?this._contentTypes=t.slice():this._contentTypes=[],this._contentTypes.push("application/json"),r&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=n,this._jwtHandler=r}return e.prototype.getJson=function(e,t){var n=this;if(!e)throw r.Log.error("JsonService.getJson: No url passed"),new Error("url");return r.Log.debug("JsonService.getJson, url: ",e),new Promise(function(o,i){var s=new n._XMLHttpRequest;s.open("GET",e);var a=n._contentTypes,u=n._jwtHandler;s.onload=function(){if(r.Log.debug("JsonService.getJson: HTTP response received, status",s.status),200===s.status){var t=s.getResponseHeader("Content-Type");if(t){var n=a.find(function(e){if(t.startsWith(e))return!0});if("application/jwt"==n)return void u(s).then(o,i);if(n)try{return void o(JSON.parse(s.responseText))}catch(e){return r.Log.error("JsonService.getJson: Error parsing JSON response",e.message),void i(e)}}i(Error("Invalid response Content-Type: "+t+", from URL: "+e))}else i(Error(s.statusText+" ("+s.status+")"))},s.onerror=function(){r.Log.error("JsonService.getJson: network error"),i(Error("Network Error"))},t&&(r.Log.debug("JsonService.getJson: token passed, setting Authorization header"),s.setRequestHeader("Authorization","Bearer "+t)),s.send()})},e.prototype.postForm=function(e,t){var n=this;if(!e)throw r.Log.error("JsonService.postForm: No url passed"),new Error("url");return r.Log.debug("JsonService.postForm, url: ",e),new Promise(function(o,i){var s=new n._XMLHttpRequest;s.open("POST",e);var a=n._contentTypes;s.onload=function(){if(r.Log.debug("JsonService.postForm: HTTP response received, status",s.status),200!==s.status){if(400===s.status&&(n=s.getResponseHeader("Content-Type"))&&a.find(function(e){if(n.startsWith(e))return!0}))try{var t=JSON.parse(s.responseText);if(t&&t.error)return r.Log.error("JsonService.postForm: Error from server: ",t.error),void i(new Error(t.error))}catch(e){return r.Log.error("JsonService.postForm: Error parsing JSON response",e.message),void i(e)}i(Error(s.statusText+" ("+s.status+")"))}else{var n;if((n=s.getResponseHeader("Content-Type"))&&a.find(function(e){if(n.startsWith(e))return!0}))try{return void o(JSON.parse(s.responseText))}catch(e){return r.Log.error("JsonService.postForm: Error parsing JSON response",e.message),void i(e)}i(Error("Invalid response Content-Type: "+n+", from URL: "+e))}},s.onerror=function(){r.Log.error("JsonService.postForm: network error"),i(Error("Network Error"))};var u="";for(var c in t){var l=t[c];l&&(u.length>0&&(u+="&"),u+=encodeURIComponent(c),u+="=",u+=encodeURIComponent(l))}s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(u)})},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.State=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(n(54));t.State=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.id,r=t.data,o=t.created,s=t.request_type;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=n||(0,i.default)(),this._data=r,this._created="number"==typeof o&&o>0?o:parseInt(Date.now()/1e3),this._request_type=s}return e.prototype.toStorageString=function(){return o.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},e.fromStorageString=function(t){return o.Log.debug("State.fromStorageString"),new e(JSON.parse(t))},e.clearStaleState=function(t,n){var r=Date.now()/1e3-n;return t.getAllKeys().then(function(n){o.Log.debug("State.clearStaleState: got keys",n);for(var i=[],s=function(s){var a=n[s];u=t.get(a).then(function(n){var i=!1;if(n)try{var s=e.fromStorageString(n);o.Log.debug("State.clearStaleState: got item from key: ",a,s.created),s.created<=r&&(i=!0)}catch(e){o.Log.error("State.clearStaleState: Error parsing state for key",a,e.message),i=!0}else o.Log.debug("State.clearStaleState: no item in storage for key: ",a),i=!0;if(i)return o.Log.debug("State.clearStaleState: removed item for key: ",a),t.remove(a)}),i.push(u)},a=0;a<n.length;a++){var u;s(a)}return o.Log.debug("State.clearStaleState: waiting on promise count:",i.length),Promise.all(i)})},r(e,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),e}()},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var r=n(23),o=n(7),i=n(11),s=n(8),a=n(15),u=n(71),c=n(33),l=n(77),p=n(1)("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,h,g,v,_){u(n,t,h);var y,m,S,b=function(e){if(!d&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",k="values"==g,E=!1,T=e.prototype,L=T[p]||T["@@iterator"]||g&&T[g],x=L||b(g),R=g?k?b("entries"):x:void 0,I="Array"==t&&T.entries||L;if(I&&(S=l(I.call(new e)))!==Object.prototype&&S.next&&(c(S,w,!0),r||"function"==typeof S[p]||s(S,p,f)),k&&L&&"values"!==L.name&&(E=!0,x=function(){return L.call(this)}),r&&!_||!d&&!E&&T[p]||s(T,p,x),a[t]=x,a[w]=f,g)if(y={values:k?x:b("values"),keys:v?x:b("keys"),entries:R},_)for(m in y)m in T||i(T,m,y[m]);else o(o.P+o.F*(d||E),t,y);return y}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(2).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(1)("unscopables"),o=Array.prototype;void 0==o[r]&&n(8)(o,r,{}),e.exports=function(e){o[r][e]=!0}},function(e,t,n){var r,o,i,s=n(13),a=n(45),u=n(42),c=n(25),l=n(2),p=l.process,d=l.setImmediate,f=l.clearImmediate,h=l.MessageChannel,g=l.Dispatch,v=0,_={},y=function(){var e=+this;if(_.hasOwnProperty(e)){var t=_[e];delete _[e],t()}},m=function(e){y.call(e.data)};d&&f||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return _[++v]=function(){a("function"==typeof e?e:Function(e),t)},r(v),v},f=function(e){delete _[e]},"process"==n(10)(p)?r=function(e){p.nextTick(s(y,e,1))}:g&&g.now?r=function(e){g.now(s(y,e,1))}:h?(i=(o=new h).port2,o.port1.onmessage=m,r=s(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",m,!1)):r="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),y.call(e)}}:function(e){setTimeout(s(y,e,1),0)}),e.exports={set:d,clear:f}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){"use strict";var r=n(14);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){var r=n(13),o=n(30),i=n(34),s=n(31),a=n(105);e.exports=function(e,t){var n=1==e,u=2==e,c=3==e,l=4==e,p=6==e,d=5==e||p,f=t||a;return function(t,a,h){for(var g,v,_=i(t),y=o(_),m=r(a,h,3),S=s(y.length),b=0,w=n?f(t,S):u?f(t,0):void 0;S>b;b++)if((d||b in y)&&(v=m(g=y[b],b,_),e))if(n)w[b]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return b;case 2:w.push(g)}else if(l)return!1;return p?-1:c||l?l:w}}},function(e,t,n){var r=n(10);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClient=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=n(35),s=n(51),a=n(52),u=n(125),c=n(126),l=n(127),p=n(53),d=n(38);t.OidcClient=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof i.OidcClientSettings?this._settings=t:this._settings=new i.OidcClientSettings(t)}return e.prototype.createSigninRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.response_type,r=t.scope,i=t.redirect_uri,s=t.data,u=t.state,c=t.prompt,l=t.display,p=t.max_age,d=t.ui_locales,f=t.id_token_hint,h=t.login_hint,g=t.acr_values,v=t.resource,_=t.request,y=t.request_uri,m=t.response_mode,S=t.extraQueryParams,b=t.extraTokenParams,w=t.request_type,k=t.skipUserInfo,E=arguments[1];o.Log.debug("OidcClient.createSigninRequest");var T=this._settings.client_id;n=n||this._settings.response_type,r=r||this._settings.scope,i=i||this._settings.redirect_uri,c=c||this._settings.prompt,l=l||this._settings.display,p=p||this._settings.max_age,d=d||this._settings.ui_locales,g=g||this._settings.acr_values,v=v||this._settings.resource,m=m||this._settings.response_mode,S=S||this._settings.extraQueryParams,b=b||this._settings.extraTokenParams;var L=this._settings.authority;return a.SigninRequest.isCode(n)&&"code"!==n?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then(function(t){o.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",t);var x=new a.SigninRequest({url:t,client_id:T,redirect_uri:i,response_type:n,scope:r,data:s||u,authority:L,prompt:c,display:l,max_age:p,ui_locales:d,id_token_hint:f,login_hint:h,acr_values:g,resource:v,request:_,request_uri:y,extraQueryParams:S,extraTokenParams:b,request_type:w,response_mode:m,client_secret:e._settings.client_secret,skipUserInfo:k}),R=x.state;return(E=E||e._stateStore).set(R.id,R.toStorageString()).then(function(){return x})})},e.prototype.readSigninResponseState=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o.Log.debug("OidcClient.readSigninResponseState");var r="query"===this._settings.response_mode||!this._settings.response_mode&&a.SigninRequest.isCode(this._settings.response_type)?"?":"#",i=new u.SigninResponse(e,r);return i.state?(t=t||this._stateStore,(n?t.remove.bind(t):t.get.bind(t))(i.state).then(function(e){if(!e)throw o.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:p.SigninState.fromStorageString(e),response:i}})):(o.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response")))},e.prototype.processSigninResponse=function(e,t){var n=this;return o.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(e,t,!0).then(function(e){var t=e.state,r=e.response;return o.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),n._validator.validateSigninResponse(t,r)})},e.prototype.createSignoutRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.id_token_hint,r=t.data,i=t.state,s=t.post_logout_redirect_uri,a=t.extraQueryParams,u=t.request_type,l=arguments[1];return o.Log.debug("OidcClient.createSignoutRequest"),s=s||this._settings.post_logout_redirect_uri,a=a||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then(function(t){if(!t)throw o.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");o.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",t);var p=new c.SignoutRequest({url:t,id_token_hint:n,post_logout_redirect_uri:s,data:r||i,extraQueryParams:a,request_type:u}),d=p.state;return d&&(o.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(l=l||e._stateStore).set(d.id,d.toStorageString())),p})},e.prototype.readSignoutResponseState=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o.Log.debug("OidcClient.readSignoutResponseState");var r=new l.SignoutResponse(e);if(!r.state)return o.Log.debug("OidcClient.readSignoutResponseState: No state in response"),r.error?(o.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",r.error),Promise.reject(new s.ErrorResponse(r))):Promise.resolve({undefined:void 0,response:r});var i=r.state;return t=t||this._stateStore,(n?t.remove.bind(t):t.get.bind(t))(i).then(function(e){if(!e)throw o.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:d.State.fromStorageString(e),response:r}})},e.prototype.processSignoutResponse=function(e,t){var n=this;return o.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(e,t,!0).then(function(e){var t=e.state,r=e.response;return t?(o.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),n._validator.validateSignoutResponse(t,r)):(o.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),r)})},e.prototype.clearStaleState=function(e){return o.Log.debug("OidcClient.clearStaleState"),e=e||this._stateStore,d.State.clearStaleState(e,this.settings.staleStateAge)},r(e,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenClient=void 0;var r=n(37),o=n(9),i=n(0);t.TokenClient=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.JsonService,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.MetadataService;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw i.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new n,this._metadataService=new s(this._settings)}return e.prototype.exchangeCode=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t=Object.assign({},t)).grant_type=t.grant_type||"authorization_code",t.client_id=t.client_id||this._settings.client_id,t.redirect_uri=t.redirect_uri||this._settings.redirect_uri,t.code?t.redirect_uri?t.code_verifier?t.client_id?this._metadataService.getTokenEndpoint(!1).then(function(n){return i.Log.debug("TokenClient.exchangeCode: Received token endpoint"),e._jsonService.postForm(n,t).then(function(e){return i.Log.debug("TokenClient.exchangeCode: response received"),e})}):(i.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(i.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(i.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(i.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},e.prototype.exchangeRefreshToken=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t=Object.assign({},t)).grant_type=t.grant_type||"refresh_token",t.client_id=t.client_id||this._settings.client_id,t.client_secret=t.client_secret||this._settings.client_secret,t.refresh_token?t.client_id?this._metadataService.getTokenEndpoint(!1).then(function(n){return i.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),e._jsonService.postForm(n,t).then(function(e){return i.Log.debug("TokenClient.exchangeRefreshToken: response received"),e})}):(i.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(i.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorResponse=void 0;var r=n(0);t.ErrorResponse=function(e){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.error,i=n.error_description,s=n.error_uri,a=n.state,u=n.session_state;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!o)throw r.Log.error("No error passed to ErrorResponse"),new Error("error");var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i||o));return c.name="ErrorResponse",c.error=o,c.error_description=i,c.error_uri=s,c.state=a,c.session_state=u,c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(Error)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SigninRequest=void 0;var r=n(0),o=n(16),i=n(53);t.SigninRequest=function(){function e(t){var n=t.url,s=t.client_id,a=t.redirect_uri,u=t.response_type,c=t.scope,l=t.authority,p=t.data,d=t.prompt,f=t.display,h=t.max_age,g=t.ui_locales,v=t.id_token_hint,_=t.login_hint,y=t.acr_values,m=t.resource,S=t.response_mode,b=t.request,w=t.request_uri,k=t.extraQueryParams,E=t.request_type,T=t.client_secret,L=t.extraTokenParams,x=t.skipUserInfo;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!n)throw r.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!s)throw r.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!a)throw r.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!u)throw r.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!c)throw r.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!l)throw r.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var R=e.isOidc(u),I=e.isCode(u);S||(S=e.isCode(u)?"query":null),this.state=new i.SigninState({nonce:R,data:p,client_id:s,authority:l,redirect_uri:a,code_verifier:I,request_type:E,response_mode:S,client_secret:T,scope:c,extraTokenParams:L,skipUserInfo:x}),n=o.UrlUtility.addQueryParam(n,"client_id",s),n=o.UrlUtility.addQueryParam(n,"redirect_uri",a),n=o.UrlUtility.addQueryParam(n,"response_type",u),n=o.UrlUtility.addQueryParam(n,"scope",c),n=o.UrlUtility.addQueryParam(n,"state",this.state.id),R&&(n=o.UrlUtility.addQueryParam(n,"nonce",this.state.nonce)),I&&(n=o.UrlUtility.addQueryParam(n,"code_challenge",this.state.code_challenge),n=o.UrlUtility.addQueryParam(n,"code_challenge_method","S256"));var O={prompt:d,display:f,max_age:h,ui_locales:g,id_token_hint:v,login_hint:_,acr_values:y,resource:m,request:b,request_uri:w,response_mode:S};for(var P in O)O[P]&&(n=o.UrlUtility.addQueryParam(n,P,O[P]));for(var C in k)n=o.UrlUtility.addQueryParam(n,C,k[C]);this.url=n}return e.isOidc=function(e){return!!e.split(/\s+/g).filter(function(e){return"id_token"===e})[0]},e.isOAuth=function(e){return!!e.split(/\s+/g).filter(function(e){return"token"===e})[0]},e.isCode=function(e){return!!e.split(/\s+/g).filter(function(e){return"code"===e})[0]},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SigninState=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=n(38),s=n(20),a=function(e){return e&&e.__esModule?e:{default:e}}(n(54));t.SigninState=function(e){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.nonce,o=n.authority,i=n.client_id,u=n.redirect_uri,c=n.code_verifier,l=n.response_mode,p=n.client_secret,d=n.scope,f=n.extraTokenParams,h=n.skipUserInfo;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var g=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,arguments[0]));if(!0===r?g._nonce=(0,a.default)():r&&(g._nonce=r),!0===c?g._code_verifier=(0,a.default)()+(0,a.default)()+(0,a.default)():c&&(g._code_verifier=c),g.code_verifier){var v=s.JoseUtil.hashString(g.code_verifier,"SHA256");g._code_challenge=s.JoseUtil.hexToBase64Url(v)}return g._redirect_uri=u,g._authority=o,g._client_id=i,g._response_mode=l,g._client_secret=p,g._scope=d,g._extraTokenParams=f,g._skipUserInfo=h,g}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.toStorageString=function(){return o.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},t.fromStorageString=function(e){return o.Log.debug("SigninState.fromStorageString"),new t(JSON.parse(e))},r(t,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),t}(i.State)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,r.default)().replace(/-/g,"")};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(122));e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0);t.User=function(){function e(t){var n=t.id_token,r=t.session_state,o=t.access_token,i=t.refresh_token,s=t.token_type,a=t.scope,u=t.profile,c=t.expires_at,l=t.state;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id_token=n,this.session_state=r,this.access_token=o,this.refresh_token=i,this.token_type=s,this.scope=a,this.profile=u,this.expires_at=c,this.state=l}return e.prototype.toStorageString=function(){return o.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},e.fromStorageString=function(t){return o.Log.debug("User.fromStorageString"),new e(JSON.parse(t))},r(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}},set:function(e){var t=parseInt(e);if("number"==typeof t&&t>0){var n=parseInt(Date.now()/1e3);this.expires_at=n+t}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenEvents=void 0;var r=n(0),o=n(137),i=60;t.AccessTokenEvents=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.accessTokenExpiringNotificationTime,r=void 0===n?i:n,s=t.accessTokenExpiringTimer,a=void 0===s?new o.Timer("Access token expiring"):s,u=t.accessTokenExpiredTimer,c=void 0===u?new o.Timer("Access token expired"):u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._accessTokenExpiringNotificationTime=r,this._accessTokenExpiring=a,this._accessTokenExpired=c}return e.prototype.load=function(e){if(e.access_token&&void 0!==e.expires_in){var t=e.expires_in;if(r.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",t),t>0){var n=t-this._accessTokenExpiringNotificationTime;n<=0&&(n=1),r.Log.debug("AccessTokenEvents.load: registering expiring timer in:",n),this._accessTokenExpiring.init(n)}else r.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var o=t+1;r.Log.debug("AccessTokenEvents.load: registering expired timer in:",o),this._accessTokenExpired.init(o)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.unload=function(){r.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.addAccessTokenExpiring=function(e){this._accessTokenExpiring.addHandler(e)},e.prototype.removeAccessTokenExpiring=function(e){this._accessTokenExpiring.removeHandler(e)},e.prototype.addAccessTokenExpired=function(e){this._accessTokenExpired.addHandler(e)},e.prototype.removeAccessTokenExpired=function(e){this._accessTokenExpired.removeHandler(e)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var r=n(0);t.Event=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._callbacks=[]}return e.prototype.addHandler=function(e){this._callbacks.push(e)},e.prototype.removeHandler=function(e){var t=this._callbacks.findIndex(function(t){return t===e});t>=0&&this._callbacks.splice(t,1)},e.prototype.raise=function(){r.Log.debug("Event: Raising event: "+this._name);for(var e=0;e<this._callbacks.length;e++){var t;(t=this._callbacks)[e].apply(t,arguments)}},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMonitor=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=n(59),s=n(4);t.SessionMonitor=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.CheckSessionIFrame,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.Global.timer;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw o.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=t,this._CheckSessionIFrameCtor=r,this._timer=a,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),this._userManager.getUser().then(function(e){e?n._start(e):n._settings.monitorAnonymousSession&&n._userManager.querySessionStatus().then(function(e){var t={session_state:e.session_state};e.sub&&e.sid&&(t.profile={sub:e.sub,sid:e.sid}),n._start(t)}).catch(function(e){o.Log.error("SessionMonitor ctor: error from querySessionStatus:",e.message)})}).catch(function(e){o.Log.error("SessionMonitor ctor: error from getUser:",e.message)})}return e.prototype._start=function(e){var t=this,n=e.session_state;n&&(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,o.Log.debug("SessionMonitor._start: session_state:",n,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,o.Log.debug("SessionMonitor._start: session_state:",n,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(n):this._metadataService.getCheckSessionIframe().then(function(e){if(e){o.Log.debug("SessionMonitor._start: Initializing check session iframe");var r=t._client_id,i=t._checkSessionInterval,s=t._stopCheckSessionOnError;t._checkSessionIFrame=new t._CheckSessionIFrameCtor(t._callback.bind(t),r,e,i,s),t._checkSessionIFrame.load().then(function(){t._checkSessionIFrame.start(n)})}else o.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")}).catch(function(e){o.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",e.message)}))},e.prototype._stop=function(){var e=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(o.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var t=this._timer.setInterval(function(){e._timer.clearInterval(t),e._userManager.querySessionStatus().then(function(t){var n={session_state:t.session_state};t.sub&&t.sid&&(n.profile={sub:t.sub,sid:t.sid}),e._start(n)}).catch(function(e){o.Log.error("SessionMonitor: error from querySessionStatus:",e.message)})},1e3)},e.prototype._callback=function(){var e=this;this._userManager.querySessionStatus().then(function(t){var n=!0;t?t.sub===e._sub?(n=!1,e._checkSessionIFrame.start(t.session_state),t.sid===e._sid?o.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",t.session_state):(o.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",t.session_state),e._userManager.events._raiseUserSessionChanged())):o.Log.debug("SessionMonitor._callback: Different subject signed into OP:",t.sub):o.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),n&&(e._sub?(o.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),e._userManager.events._raiseUserSignedOut()):(o.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),e._userManager.events._raiseUserSignedIn()))}).catch(function(t){e._sub&&(o.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",t.message),e._userManager.events._raiseUserSignedOut())})},r(e,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckSessionIFrame=void 0;var r=n(0),o=2e3;t.CheckSessionIFrame=function(){function e(t,n,r,i){var s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._callback=t,this._client_id=n,this._url=r,this._interval=i||o,this._stopOnError=s;var a=r.indexOf("/",r.indexOf("//")+2);this._frame_origin=r.substr(0,a),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.style.width=0,this._frame.style.height=0,this._frame.src=r}return e.prototype.load=function(){var e=this;return new Promise(function(t){e._frame.onload=function(){t()},window.document.body.appendChild(e._frame),e._boundMessageEvent=e._message.bind(e),window.addEventListener("message",e._boundMessageEvent,!1)})},e.prototype._message=function(e){e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(r.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(r.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):r.Log.debug("CheckSessionIFrame: "+e.data+" message from check session op iframe"))},e.prototype.start=function(e){var t=this;if(this._session_state!==e){r.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=e;var n=function(){t._frame.contentWindow.postMessage(t._client_id+" "+t._session_state,t._frame_origin)};n(),this._timer=window.setInterval(n,this._interval)}},e.prototype.stop=function(){this._session_state=null,this._timer&&(r.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRevocationClient=void 0;var r=n(0),o=n(9),i=n(4);t.TokenRevocationClient=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Global.XMLHttpRequest,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.MetadataService;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw r.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=t,this._XMLHttpRequestCtor=n,this._metadataService=new s(this._settings)}return e.prototype.revoke=function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"access_token";if(!e)throw r.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if("access_token"!==o&&"refresh_token"!=o)throw r.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then(function(i){if(i){r.Log.debug("TokenRevocationClient.revoke: Revoking "+o);var s=n._settings.client_id,a=n._settings.client_secret;return n._revoke(i,s,a,e,o)}if(t)throw r.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")})},e.prototype._revoke=function(e,t,n,o,i){var s=this;return new Promise(function(a,u){var c=new s._XMLHttpRequestCtor;c.open("POST",e),c.onload=function(){r.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",c.status),200===c.status?a():u(Error(c.statusText+" ("+c.status+")"))},c.onerror=function(){r.Log.debug("TokenRevocationClient.revoke: Network Error."),u("Network Error")};var l="client_id="+encodeURIComponent(t);n&&(l+="&client_secret="+encodeURIComponent(n)),l+="&token_type_hint="+encodeURIComponent(i),l+="&token="+encodeURIComponent(o),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send(l)})},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupWindow=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i="location=no,toolbar=no,zoom=no",s="_blank";t.CordovaPopupWindow=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise(function(e,t){n._resolve=e,n._reject=t}),this.features=t.popupWindowFeatures||i,this.target=t.popupWindowTarget||s,this.redirect_uri=t.startUrl,o.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return e.prototype._isInAppBrowserInstalled=function(e){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some(function(t){return e.hasOwnProperty(t)})},e.prototype.navigate=function(e){if(e&&e.url){if(!window.cordova)return this._error("cordova is undefined");var t=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(t))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(e.url,this.target,this.features),this._popup?(o.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},e.prototype._loadStartCallback=function(e){0===e.url.indexOf(this.redirect_uri)&&this._success({url:e.url})},e.prototype._exitCallback=function(e){this._error(e)},e.prototype._success=function(e){this._cleanup(),o.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),o.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._popup&&(o.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},r(e,[{key:"promise",get:function(){return this._promise}}]),e}()},function(e,t,n){n(63),e.exports=n(113)},function(e,t,n){"use strict";n(64),n(95),n(98),n(103),n(107),n(110),n(112)},function(e,t,n){n(65),n(69),n(78),n(81),e.exports=n(3).Promise},function(e,t,n){"use strict";var r=n(21),o={};o[n(1)("toStringTag")]="z",o+""!="[object z]"&&n(11)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t,n){e.exports=!n(12)&&!n(18)(function(){return 7!=Object.defineProperty(n(25)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(6);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){e.exports=n(22)("native-function-to-string",Function.toString)},function(e,t,n){"use strict";var r=n(70)(!0);n(40)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var r=n(26),o=n(27);e.exports=function(e){return function(t,n){var i,s,a=String(o(t)),u=r(n),c=a.length;return u<0||u>=c?e?"":void 0:(i=a.charCodeAt(u))<55296||i>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?e?a.charAt(u):i:e?a.slice(u,u+2):s-56320+(i-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(72),o=n(39),i=n(33),s={};n(8)(s,n(1)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(s,{next:o(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(5),o=n(73),i=n(41),s=n(32)("IE_PROTO"),a=function(){},u=function(){var e,t=n(25)("iframe"),r=i.length;for(t.style.display="none",n(42).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[i[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=u(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(17),o=n(5),i=n(28);e.exports=n(12)?Object.defineProperties:function(e,t){o(e);for(var n,s=i(t),a=s.length,u=0;a>u;)r.f(e,n=s[u++],t[n]);return e}},function(e,t,n){var r=n(19),o=n(29),i=n(75)(!1),s=n(32)("IE_PROTO");e.exports=function(e,t){var n,a=o(e),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;t.length>u;)r(a,n=t[u++])&&(~i(c,n)||c.push(n));return c}},function(e,t,n){var r=n(29),o=n(31),i=n(76);e.exports=function(e){return function(t,n,s){var a,u=r(t),c=o(u.length),l=i(s,c);if(e&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var r=n(26),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},function(e,t,n){var r=n(19),o=n(34),i=n(32)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,n){for(var r=n(79),o=n(28),i=n(11),s=n(2),a=n(8),u=n(15),c=n(1),l=c("iterator"),p=c("toStringTag"),d=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=o(f),g=0;g<h.length;g++){var v,_=h[g],y=f[_],m=s[_],S=m&&m.prototype;if(S&&(S[l]||a(S,l,d),S[p]||a(S,p,_),u[_]=d,y))for(v in r)S[v]||i(S,v,r[v],!0)}},function(e,t,n){"use strict";var r=n(43),o=n(80),i=n(15),s=n(29);e.exports=n(40)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r,o,i,s,a=n(23),u=n(2),c=n(13),l=n(21),p=n(7),d=n(6),f=n(14),h=n(82),g=n(83),v=n(87),_=n(44).set,y=n(88)(),m=n(46),S=n(89),b=n(90),w=n(91),k=u.TypeError,E=u.process,T=E&&E.versions,L=T&&T.v8||"",x=u.Promise,R="process"==l(E),I=function(){},O=o=m.f,P=!!function(){try{var e=x.resolve(1),t=(e.constructor={})[n(1)("species")]=function(e){e(I,I)};return(R||"function"==typeof PromiseRejectionEvent)&&e.then(I)instanceof t&&0!==L.indexOf("6.6")&&-1===b.indexOf("Chrome/66")}catch(e){}}(),C=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},U=function(e,t){if(!e._n){e._n=!0;var n=e._c;y(function(){for(var r=e._v,o=1==e._s,i=0,s=function(t){var n,i,s,a=o?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{a?(o||(2==e._h&&N(e),e._h=1),!0===a?n=r:(l&&l.enter(),n=a(r),l&&(l.exit(),s=!0)),n===t.promise?c(k("Promise-chain cycle")):(i=C(n))?i.call(n,u,c):u(n)):c(r)}catch(e){l&&!s&&l.exit(),c(e)}};n.length>i;)s(n[i++]);e._c=[],e._n=!1,t&&!e._h&&j(e)})}},j=function(e){_.call(u,function(){var t,n,r,o=e._v,i=M(e);if(i&&(t=S(function(){R?E.emit("unhandledRejection",o,e):(n=u.onunhandledrejection)?n({promise:e,reason:o}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",o)}),e._h=R||M(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},M=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){_.call(u,function(){var t;R?E.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},A=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),U(t,!0))},W=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw k("Promise can't be resolved itself");(t=C(e))?y(function(){var r={_w:n,_d:!1};try{t.call(e,c(W,r,1),c(A,r,1))}catch(e){A.call(r,e)}}):(n._v=e,n._s=1,U(n,!1))}catch(e){A.call({_w:n,_d:!1},e)}}};P||(x=function e(t){h(this,x,"Promise","_h"),f(t),r.call(this);try{t(c(W,this,1),c(A,this,1))}catch(e){A.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(92)(x.prototype,{then:function(e,t){var n=O(v(this,x));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=R?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&U(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=c(W,e,1),this.reject=c(A,e,1)},m.f=O=function(e){return e===x||e===s?new i(e):o(e)}),p(p.G+p.W+p.F*!P,{Promise:x}),n(33)(x,"Promise"),n(93)("Promise"),s=n(3).Promise,p(p.S+p.F*!P,"Promise",{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),p(p.S+p.F*(a||!P),"Promise",{resolve:function(e){return w(a&&this===s?x:this,e)}}),p(p.S+p.F*!(P&&n(94)(function(e){x.all(e).catch(I)})),"Promise",{all:function(e){var t=this,n=O(t),r=n.resolve,o=n.reject,i=S(function(){var n=[],i=0,s=1;g(e,!1,function(e){var a=i++,u=!1;n.push(void 0),s++,t.resolve(e).then(function(e){u||(u=!0,n[a]=e,--s||r(n))},o)}),--s||r(n)});return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=O(t),r=n.reject,o=S(function(){g(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(13),o=n(84),i=n(85),s=n(5),a=n(31),u=n(86),c={},l={};(t=e.exports=function(e,t,n,p,d){var f,h,g,v,_=d?function(){return e}:u(e),y=r(n,p,t?2:1),m=0;if("function"!=typeof _)throw TypeError(e+" is not iterable!");if(i(_)){for(f=a(e.length);f>m;m++)if((v=t?y(s(h=e[m])[0],h[1]):y(e[m]))===c||v===l)return v}else for(g=_.call(e);!(h=g.next()).done;)if((v=o(g,y,h.value,t))===c||v===l)return v}).BREAK=c,t.RETURN=l},function(e,t,n){var r=n(5);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(15),o=n(1)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t,n){var r=n(21),o=n(1)("iterator"),i=n(15);e.exports=n(3).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(5),o=n(14),i=n(1)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||void 0==(n=r(s)[i])?t:o(n)}},function(e,t,n){var r=n(2),o=n(44).set,i=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,u="process"==n(10)(s);e.exports=function(){var e,t,n,c=function(){var r,o;for(u&&(r=s.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(u)n=function(){s.nextTick(c)};else if(!i||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var l=a.resolve(void 0);n=function(){l.then(c)}}else n=function(){o.call(r,c)};else{var p=!0,d=document.createTextNode("");new i(c).observe(d,{characterData:!0}),n=function(){d.data=p=!p}}return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(2).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(5),o=n(6),i=n(46);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){var r=n(11);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t,n){"use strict";var r=n(2),o=n(17),i=n(12),s=n(1)("species");e.exports=function(e){var t=r[e];i&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(1)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],s=i[r]();s.next=function(){return{done:n=!0}},i[r]=function(){return s},e(i)}catch(e){}return n}},function(e,t,n){n(96),e.exports=n(3).Function.bind},function(e,t,n){var r=n(7);r(r.P,"Function",{bind:n(97)})},function(e,t,n){"use strict";var r=n(14),o=n(6),i=n(45),s=[].slice,a={};e.exports=Function.bind||function(e){var t=r(this),n=s.call(arguments,1),u=function(){var r=n.concat(s.call(arguments));return this instanceof u?function(e,t,n){if(!(t in a)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";a[t]=Function("F,a","return new F("+r.join(",")+")")}return a[t](e,n)}(t,r.length,r):i(t,r,e)};return o(t.prototype)&&(u.prototype=t.prototype),u}},function(e,t,n){n(99),e.exports=n(3).Object.assign},function(e,t,n){var r=n(7);r(r.S+r.F,"Object",{assign:n(100)})},function(e,t,n){"use strict";var r=n(28),o=n(101),i=n(102),s=n(34),a=n(30),u=Object.assign;e.exports=!u||n(18)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r})?function(e,t){for(var n=s(e),u=arguments.length,c=1,l=o.f,p=i.f;u>c;)for(var d,f=a(arguments[c++]),h=l?r(f).concat(l(f)):r(f),g=h.length,v=0;g>v;)p.call(f,d=h[v++])&&(n[d]=f[d]);return n}:u},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){n(104),e.exports=n(3).Array.find},function(e,t,n){"use strict";var r=n(7),o=n(47)(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),r(r.P+r.F*i,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(43)("find")},function(e,t,n){var r=n(106);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(6),o=n(48),i=n(1)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){n(108),e.exports=n(3).Array.some},function(e,t,n){"use strict";var r=n(7),o=n(47)(3);r(r.P+r.F*!n(109)([].some,!0),"Array",{some:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t,n){n(111),e.exports=n(3).Array.isArray},function(e,t,n){var r=n(7);r(r.S,"Array",{isArray:n(48)})},function(e,t){e.exports=function(){return Function.call.apply(Array.prototype.splice,arguments)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(49),i=n(35),s=n(36),a=n(128),u=n(129),c=n(56),l=n(9),p=n(139),d=n(140),f=n(59),h=n(60),g=n(58),v=n(4),_=n(55),y=n(141);t.default={Version:y.Version,Log:r.Log,OidcClient:o.OidcClient,OidcClientSettings:i.OidcClientSettings,WebStorageStateStore:s.WebStorageStateStore,InMemoryWebStorage:a.InMemoryWebStorage,UserManager:u.UserManager,AccessTokenEvents:c.AccessTokenEvents,MetadataService:l.MetadataService,CordovaPopupNavigator:p.CordovaPopupNavigator,CordovaIFrameNavigator:d.CordovaIFrameNavigator,CheckSessionIFrame:f.CheckSessionIFrame,TokenRevocationClient:h.TokenRevocationClient,SessionMonitor:g.SessionMonitor,Global:v.Global,User:_.User},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseValidator=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(0),i=n(9),s=n(115),a=n(50),u=n(51),c=n(20),l=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];t.ResponseValidator=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.MetadataService,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.UserInfoService,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.JoseUtil,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a.TokenClient;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw o.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=t,this._metadataService=new n(this._settings),this._userInfoService=new r(this._settings),this._joseUtil=u,this._tokenClient=new l(this._settings)}return e.prototype.validateSigninResponse=function(e,t){var n=this;return o.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(e,t).then(function(t){return o.Log.debug("ResponseValidator.validateSigninResponse: state processed"),n._validateTokens(e,t).then(function(t){return o.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),n._processClaims(e,t).then(function(e){return o.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),e})})})},e.prototype.validateSignoutResponse=function(e,t){return e.id!==t.state?(o.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(o.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),t.state=e.data,t.error?(o.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",t.error),Promise.reject(new u.ErrorResponse(t))):Promise.resolve(t))},e.prototype._processSigninParams=function(e,t){if(e.id!==t.state)return o.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!e.client_id)return o.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!e.authority)return o.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==e.authority)return o.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=e.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==e.client_id)return o.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=e.client_id;return o.Log.debug("ResponseValidator._processSigninParams: state validated"),t.state=e.data,t.error?(o.Log.warn("ResponseValidator._processSigninParams: Response was error",t.error),Promise.reject(new u.ErrorResponse(t))):e.nonce&&!t.id_token?(o.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!e.nonce&&t.id_token?(o.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):e.code_verifier&&!t.code?(o.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!e.code_verifier&&t.code?(o.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(t.scope||(t.scope=e.scope),Promise.resolve(t))},e.prototype._processClaims=function(e,t){var n=this;if(t.isOpenIdConnect){if(o.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),t.profile=this._filterProtocolClaims(t.profile),!0!==e.skipUserInfo&&this._settings.loadUserInfo&&t.access_token)return o.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(t.access_token).then(function(e){return o.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),e.sub!==t.profile.sub?(o.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in access_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in access_token"))):(t.profile=n._mergeClaims(t.profile,e),o.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",t.profile),t)});o.Log.debug("ResponseValidator._processClaims: not loading user info")}else o.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(t)},e.prototype._mergeClaims=function(e,t){var n=Object.assign({},e);for(var o in t){var i=t[o];Array.isArray(i)||(i=[i]);for(var s=0;s<i.length;s++){var a=i[s];n[o]?Array.isArray(n[o])?n[o].indexOf(a)<0&&n[o].push(a):n[o]!==a&&("object"===(void 0===a?"undefined":r(a))?n[o]=this._mergeClaims(n[o],a):n[o]=[n[o],a]):n[o]=a}}return n},e.prototype._filterProtocolClaims=function(e){o.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",e);var t=Object.assign({},e);return this._settings._filterProtocolClaims?(l.forEach(function(e){delete t[e]}),o.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",t)):o.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),t},e.prototype._validateTokens=function(e,t){return t.code?(o.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(e,t)):t.id_token?t.access_token?(o.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(e,t)):(o.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(e,t)):(o.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(t))},e.prototype._processCode=function(e,t){var n=this,i={client_id:e.client_id,client_secret:e.client_secret,code:t.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier};return e.extraTokenParams&&"object"===r(e.extraTokenParams)&&Object.assign(i,e.extraTokenParams),this._tokenClient.exchangeCode(i).then(function(r){for(var i in r)t[i]=r[i];return t.id_token?(o.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),n._validateIdTokenAttributes(e,t)):(o.Log.debug("ResponseValidator._processCode: token response successful, returning response"),t)})},e.prototype._validateIdTokenAttributes=function(e,t){var n=this;return this._metadataService.getIssuer().then(function(r){var i=e.client_id,s=n._settings.clockSkew;return o.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",s),n._joseUtil.validateJwtAttributes(t.id_token,r,i,s).then(function(n){return e.nonce&&e.nonce!==n.nonce?(o.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):n.sub?(t.profile=n,t):(o.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})},e.prototype._validateIdTokenAndAccessToken=function(e,t){var n=this;return this._validateIdToken(e,t).then(function(e){return n._validateAccessToken(e)})},e.prototype._validateIdToken=function(e,t){var n=this;if(!e.nonce)return o.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var r=this._joseUtil.parseJwt(t.id_token);if(!r||!r.header||!r.payload)return o.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",r),Promise.reject(new Error("Failed to parse id_token"));if(e.nonce!==r.payload.nonce)return o.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"));var i=r.header.kid;return this._metadataService.getIssuer().then(function(s){return o.Log.debug("ResponseValidator._validateIdToken: Received issuer"),n._metadataService.getSigningKeys().then(function(a){if(!a)return o.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));o.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var u=void 0;if(i)u=a.filter(function(e){return e.kid===i})[0];else{if((a=n._filterByAlg(a,r.header.alg)).length>1)return o.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));u=a[0]}if(!u)return o.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var c=e.client_id,l=n._settings.clockSkew;return o.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",l),n._joseUtil.validateJwt(t.id_token,u,s,c,l).then(function(){return o.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),r.payload.sub?(t.profile=r.payload,t):(o.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})})},e.prototype._filterByAlg=function(e,t){var n=null;if(t.startsWith("RS"))n="RSA";else if(t.startsWith("PS"))n="PS";else{if(!t.startsWith("ES"))return o.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",t),[];n="EC"}return o.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",n),e=e.filter(function(e){return e.kty===n}),o.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",n,e.length),e},e.prototype._validateAccessToken=function(e){if(!e.profile)return o.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!e.profile.at_hash)return o.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!e.id_token)return o.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var t=this._joseUtil.parseJwt(e.id_token);if(!t||!t.header)return o.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",t),Promise.reject(new Error("Failed to parse id_token"));var n=t.header.alg;if(!n||5!==n.length)return o.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",n),Promise.reject(new Error("Unsupported alg: "+n));var r=n.substr(2,3);if(!r)return o.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",n,r),Promise.reject(new Error("Unsupported alg: "+n));if(256!==(r=parseInt(r))&&384!==r&&512!==r)return o.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",n,r),Promise.reject(new Error("Unsupported alg: "+n));var i="sha"+r,s=this._joseUtil.hashString(e.access_token,i);if(!s)return o.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",i),Promise.reject(new Error("Failed to validate at_hash"));var a=s.substr(0,s.length/2),u=this._joseUtil.hexToBase64Url(a);return u!==e.profile.at_hash?(o.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",u,e.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(o.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(e))},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInfoService=void 0;var r=n(37),o=n(9),i=n(0),s=n(20);t.UserInfoService=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.JsonService,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.MetadataService,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.JoseUtil;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw i.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new n(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new a(this._settings),this._joseUtil=u}return e.prototype.getClaims=function(e){var t=this;return e?this._metadataService.getUserInfoEndpoint().then(function(n){return i.Log.debug("UserInfoService.getClaims: received userinfo url",n),t._jsonService.getJson(n,e).then(function(e){return i.Log.debug("UserInfoService.getClaims: claims received",e),e})}):(i.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},e.prototype._getClaimsFromJwt=function e(t){var n=this;try{var r=this._joseUtil.parseJwt(t.responseText);if(!r||!r.header||!r.payload)return i.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",r),Promise.reject(new Error("Failed to parse id_token"));var o=r.header.kid,s=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":s=this._metadataService.getIssuer();break;case"ANY":s=Promise.resolve(r.payload.iss);break;default:s=Promise.resolve(this._settings.userInfoJwtIssuer)}return s.then(function(e){return i.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+e),n._metadataService.getSigningKeys().then(function(s){if(!s)return i.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));i.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var a=void 0;if(o)a=s.filter(function(e){return e.kid===o})[0];else{if((s=n._filterByAlg(s,r.header.alg)).length>1)return i.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));a=s[0]}if(!a)return i.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var u=n._settings.client_id,c=n._settings.clockSkew;return i.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",c),n._joseUtil.validateJwt(t.responseText,a,e,u,c,void 0,!0).then(function(){return i.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),r.payload})})})}catch(e){return i.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",e.message),void reject(e)}},e.prototype._filterByAlg=function(e,t){var n=null;if(t.startsWith("RS"))n="RSA";else if(t.startsWith("PS"))n="PS";else{if(!t.startsWith("ES"))return i.Log.debug("UserInfoService._filterByAlg: alg not supported: ",t),[];n="EC"}return i.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",n),e=e.filter(function(e){return e.kty===n}),i.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",n,e.length),e},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllowedSigningAlgs=t.b64tohex=t.hextob64u=t.crypto=t.X509=t.KeyUtil=t.jws=void 0;var r=s(n(117)),o=s(n(118)),i=s(n(120));function s(e){return e&&e.__esModule?e:{default:e}}var a=r.default.BigInteger,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c={b64tohex:function(e){var t,n,r="",o=0;for(t=0;t<e.length&&"="!==e.charAt(t);++t){var i=u.indexOf(e.charAt(t));i<0||(0===o?(r+=String.fromCharCode(i>>2),n=3&i,o=1):1===o?(r+=String.fromCharCode(n<<2|i>>4),n=15&i,o=2):2===o?(r+=String.fromCharCode(n),r+=String.fromCharCode(i>>2),n=3&i,o=3):(r+=String.fromCharCode(n<<2|i>>4),r+=String.fromCharCode(15&i),o=0))}return 1===o&&(r+=String.fromCharCode(n<<2)),r},hexToBase64:function(e){var t,n,r="";for(t=0;t+3<=e.length;t+=3)n=parseInt(e.substring(t,t+3),16),r+=u.charAt(n>>6)+u.charAt(63&n);for(t+1===e.length?(n=parseInt(e.substring(t,t+1),16),r+=u.charAt(n<<2)):t+2===e.length&&(n=parseInt(e.substring(t,t+2),16),r+=u.charAt(n>>2)+u.charAt((3&n)<<4));(3&r.length)>0;)r+="=";return r},padding:function(e){var t=e.length%4;return 0===t?e:e+new Array(4-t+1).join("=")},byteArrayToHex:function(e){for(var t="",n=0;n<e.length;n++){var r=e[n].toString(16);t+=2===r.length?r:"0"+r}return t},decodeToHEX:function(e){return c.byteArrayToHex(i.default.toByteArray(c.padding(e)))},base64ToBase64Url:function(e){return(e=(e=e.replace(/=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")},urlDecode:function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g," "),atob(e)}},l={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},p={sha256:o.default,SHA256:o.default};function d(e,t){if(this.n=null,this.e=0,!(null!=e&&null!=t&&e.length>0&&t.length>0))throw new Error("Invalid key data");this.n=new a(e,16),this.e=parseInt(t,16)}d.prototype.verify=function(e,t){t=(t=c.decodeToHEX(t)).replace(/[^0-9a-f]|[\s\n]]/gi,"");var n=new a(t,16);if(n.bitLength()>this.n.bitLength())throw new Error("Signature does not match with the key modulus.");var r=function(e){for(var t in l){var n=l[t],r=n.length;if(e.substring(0,r)===n)return{alg:t,hash:e.substring(r)}}return[]}(n.modPowInt(this.e,this.n).toString(16).replace(/^1f+00/,""));if(0===r.length)return!1;if(!p.hasOwnProperty(r.alg))throw new Error("Hashing algorithm is not supported.");var o=p[r.alg](e).toString();return r.hash===o};var f=["RS256"],h={JWS:{parse:function(e){var t,n,r=e.split(".");if(3===r.length){try{t=JSON.parse(c.urlDecode(r[0])),n=JSON.parse(c.urlDecode(r[1]))}catch(e){return new Error("Token header or payload is not valid JSON")}return{headerObj:t,payloadObj:n}}},verify:function(e,t){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).forEach(function(e){if(-1===f.indexOf(e))throw new Error("Invalid signing algorithm: "+e)});var n=new d(t.n,t.e),r=e.split("."),o=[r[0],r[1]].join(".");return n.verify(o,r[2])}}},g={getKey:function(e){return"RSA"===e.kty?{e:c.decodeToHEX(e.e),n:c.decodeToHEX(e.n)}:null}},v={getPublicKeyFromCertPEM:function(){throw new Error("Not implemented. Use the full oidc-client library if you need support for X509.")}},_={Util:{hashString:function(e,t){return(0,p[t])(e).toString()}}},y=c.b64tohex;t.jws=h,t.KeyUtil=g,t.X509=v,t.crypto=_,t.hextob64u=function(e){return e.length%2==1&&(e="0"+e),c.base64ToBase64Url(c.hexToBase64(e))},t.b64tohex=y,t.AllowedSigningAlgs=f},function(e,t,n){(function(){var t;function n(e,t,n){null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function r(){return new n(null)}var o="undefined"!=typeof navigator;o&&"Microsoft Internet Explorer"==navigator.appName?(n.prototype.am=function(e,t,n,r,o,i){for(var s=32767&t,a=t>>15;--i>=0;){var u=32767&this[e],c=this[e++]>>15,l=a*u+c*s;o=((u=s*u+((32767&l)<<15)+n[r]+(1073741823&o))>>>30)+(l>>>15)+a*c+(o>>>30),n[r++]=1073741823&u}return o},t=30):o&&"Netscape"!=navigator.appName?(n.prototype.am=function(e,t,n,r,o,i){for(;--i>=0;){var s=t*this[e++]+n[r]+o;o=Math.floor(s/67108864),n[r++]=67108863&s}return o},t=26):(n.prototype.am=function(e,t,n,r,o,i){for(var s=16383&t,a=t>>14;--i>=0;){var u=16383&this[e],c=this[e++]>>14,l=a*u+c*s;o=((u=s*u+((16383&l)<<14)+n[r]+o)>>28)+(l>>14)+a*c,n[r++]=268435455&u}return o},t=28),n.prototype.DB=t,n.prototype.DM=(1<<t)-1,n.prototype.DV=1<<t,n.prototype.FV=Math.pow(2,52),n.prototype.F1=52-t,n.prototype.F2=2*t-52;var i,s,a="0123456789abcdefghijklmnopqrstuvwxyz",u=new Array;for(i="0".charCodeAt(0),s=0;s<=9;++s)u[i++]=s;for(i="a".charCodeAt(0),s=10;s<36;++s)u[i++]=s;for(i="A".charCodeAt(0),s=10;s<36;++s)u[i++]=s;function c(e){return a.charAt(e)}function l(e,t){var n=u[e.charCodeAt(t)];return null==n?-1:n}function p(e){var t=r();return t.fromInt(e),t}function d(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function f(e){this.m=e}function h(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function g(e,t){return e&t}function v(e,t){return e|t}function _(e,t){return e^t}function y(e,t){return e&~t}function m(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function S(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function b(){}function w(e){return e}function k(e){this.r2=r(),this.q3=r(),n.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}f.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},f.prototype.revert=function(e){return e},f.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},f.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},f.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},h.prototype.convert=function(e){var t=r();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(n.ZERO)>0&&this.m.subTo(t,t),t},h.prototype.revert=function(e){var t=r();return e.copyTo(t),this.reduce(t),t},h.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e[t],r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[n=t+this.m.t]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},h.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},h.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},n.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},n.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},n.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var o=e.length,i=!1,s=0;--o>=0;){var a=8==r?255&e[o]:l(e,o);a<0?"-"==e.charAt(o)&&(i=!0):(i=!1,0==s?this[this.t++]=a:s+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&n.ZERO.subTo(this,this)},n.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},n.prototype.dlShiftTo=function(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s},n.prototype.drShiftTo=function(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s},n.prototype.lShiftTo=function(e,t){var n,r=e%this.DB,o=this.DB-r,i=(1<<o)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)t[n+s+1]=this[n]>>o|a,a=(this[n]&i)<<r;for(n=s-1;n>=0;--n)t[n]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},n.prototype.rShiftTo=function(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)t.t=0;else{var r=e%this.DB,o=this.DB-r,i=(1<<r)-1;t[0]=this[n]>>r;for(var s=n+1;s<this.t;++s)t[s-n-1]|=(this[s]&i)<<o,t[s-n]=this[s]>>r;r>0&&(t[this.t-n-1]|=(this.s&i)<<o),t.t=this.t-n,t.clamp()}},n.prototype.subTo=function(e,t){for(var n=0,r=0,o=Math.min(e.t,this.t);n<o;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()},n.prototype.multiplyTo=function(e,t){var r=this.abs(),o=e.abs(),i=r.t;for(t.t=i+o.t;--i>=0;)t[i]=0;for(i=0;i<o.t;++i)t[i+r.t]=r.am(0,o[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&n.ZERO.subTo(t,t)},n.prototype.squareTo=function(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()},n.prototype.divRemTo=function(e,t,o){var i=e.abs();if(!(i.t<=0)){var s=this.abs();if(s.t<i.t)return null!=t&&t.fromInt(0),void(null!=o&&this.copyTo(o));null==o&&(o=r());var a=r(),u=this.s,c=e.s,l=this.DB-d(i[i.t-1]);l>0?(i.lShiftTo(l,a),s.lShiftTo(l,o)):(i.copyTo(a),s.copyTo(o));var p=a.t,f=a[p-1];if(0!=f){var h=f*(1<<this.F1)+(p>1?a[p-2]>>this.F2:0),g=this.FV/h,v=(1<<this.F1)/h,_=1<<this.F2,y=o.t,m=y-p,S=null==t?r():t;for(a.dlShiftTo(m,S),o.compareTo(S)>=0&&(o[o.t++]=1,o.subTo(S,o)),n.ONE.dlShiftTo(p,S),S.subTo(a,a);a.t<p;)a[a.t++]=0;for(;--m>=0;){var b=o[--y]==f?this.DM:Math.floor(o[y]*g+(o[y-1]+_)*v);if((o[y]+=a.am(0,b,o,m,0,p))<b)for(a.dlShiftTo(m,S),o.subTo(S,o);o[y]<--b;)o.subTo(S,o)}null!=t&&(o.drShiftTo(p,t),u!=c&&n.ZERO.subTo(t,t)),o.t=p,o.clamp(),l>0&&o.rShiftTo(l,o),u<0&&n.ZERO.subTo(o,o)}}},n.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},n.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},n.prototype.exp=function(e,t){if(e>4294967295||e<1)return n.ONE;var o=r(),i=r(),s=t.convert(this),a=d(e)-1;for(s.copyTo(o);--a>=0;)if(t.sqrTo(o,i),(e&1<<a)>0)t.mulTo(i,s,o);else{var u=o;o=i,i=u}return t.revert(o)},n.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,r=(1<<t)-1,o=!1,i="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(n=this[s]>>a)>0&&(o=!0,i=c(n));s>=0;)a<t?(n=(this[s]&(1<<a)-1)<<t-a,n|=this[--s]>>(a+=this.DB-t)):(n=this[s]>>(a-=t)&r,a<=0&&(a+=this.DB,--s)),n>0&&(o=!0),o&&(i+=c(n));return o?i:"0"},n.prototype.negate=function(){var e=r();return n.ZERO.subTo(this,e),e},n.prototype.abs=function(){return this.s<0?this.negate():this},n.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(0!=(t=n-e.t))return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0},n.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+d(this[this.t-1]^this.s&this.DM)},n.prototype.mod=function(e){var t=r();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(n.ZERO)>0&&e.subTo(t,t),t},n.prototype.modPowInt=function(e,t){var n;return n=e<256||t.isEven()?new f(t):new h(t),this.exp(e,n)},n.ZERO=p(0),n.ONE=p(1),b.prototype.convert=w,b.prototype.revert=w,b.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n)},b.prototype.sqrTo=function(e,t){e.squareTo(t)},k.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=r();return e.copyTo(t),this.reduce(t),t},k.prototype.revert=function(e){return e},k.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},k.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},k.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var E,T,L,x=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],R=(1<<26)/x[x.length-1];function I(){var e;e=(new Date).getTime(),T[L++]^=255&e,T[L++]^=e>>8&255,T[L++]^=e>>16&255,T[L++]^=e>>24&255,L>=N&&(L-=N)}if(n.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},n.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),o=p(n),i=r(),s=r(),a="";for(this.divRemTo(o,i,s);i.signum()>0;)a=(n+s.intValue()).toString(e).substr(1)+a,i.divRemTo(o,i,s);return s.intValue().toString(e)+a},n.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),o=Math.pow(t,r),i=!1,s=0,a=0,u=0;u<e.length;++u){var c=l(e,u);c<0?"-"==e.charAt(u)&&0==this.signum()&&(i=!0):(a=t*a+c,++s>=r&&(this.dMultiply(o),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&n.ZERO.subTo(this,this)},n.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(n.ONE.shiftLeft(e-1),v,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(n.ONE.shiftLeft(e-1),this);else{var o=new Array,i=7&e;o.length=1+(e>>3),t.nextBytes(o),i>0?o[0]&=(1<<i)-1:o[0]=0,this.fromString(o,256)}},n.prototype.bitwiseTo=function(e,t,n){var r,o,i=Math.min(e.t,this.t);for(r=0;r<i;++r)n[r]=t(this[r],e[r]);if(e.t<this.t){for(o=e.s&this.DM,r=i;r<this.t;++r)n[r]=t(this[r],o);n.t=this.t}else{for(o=this.s&this.DM,r=i;r<e.t;++r)n[r]=t(o,e[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()},n.prototype.changeBit=function(e,t){var r=n.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},n.prototype.addTo=function(e,t){for(var n=0,r=0,o=Math.min(e.t,this.t);n<o;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[n++]=r:r<-1&&(t[n++]=this.DV+r),t.t=n,t.clamp()},n.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},n.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},n.prototype.multiplyLowerTo=function(e,t,n){var r,o=Math.min(this.t+e.t,t);for(n.s=0,n.t=o;o>0;)n[--o]=0;for(r=n.t-this.t;o<r;++o)n[o+this.t]=this.am(0,e[o],n,o,0,this.t);for(r=Math.min(e.t,t);o<r;++o)this.am(0,e[o],n,o,0,t-o);n.clamp()},n.prototype.multiplyUpperTo=function(e,t,n){--t;var r=n.t=this.t+e.t-t;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n[this.t+r-t]=this.am(t-r,e[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)},n.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this[r])%e;return n},n.prototype.millerRabin=function(e){var t=this.subtract(n.ONE),o=t.getLowestSetBit();if(o<=0)return!1;var i=t.shiftRight(o);(e=e+1>>1)>x.length&&(e=x.length);for(var s=r(),a=0;a<e;++a){s.fromInt(x[Math.floor(Math.random()*x.length)]);var u=s.modPow(i,this);if(0!=u.compareTo(n.ONE)&&0!=u.compareTo(t)){for(var c=1;c++<o&&0!=u.compareTo(t);)if(0==(u=u.modPowInt(2,this)).compareTo(n.ONE))return!1;if(0!=u.compareTo(t))return!1}}return!0},n.prototype.clone=function(){var e=r();return this.copyTo(e),e},n.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},n.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},n.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},n.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},n.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var n,r=this.DB-e*this.DB%8,o=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[o++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),0!=(128&n)&&(n|=-256),0==o&&(128&this.s)!=(128&n)&&++o,(o>0||n!=this.s)&&(t[o++]=n);return t},n.prototype.equals=function(e){return 0==this.compareTo(e)},n.prototype.min=function(e){return this.compareTo(e)<0?this:e},n.prototype.max=function(e){return this.compareTo(e)>0?this:e},n.prototype.and=function(e){var t=r();return this.bitwiseTo(e,g,t),t},n.prototype.or=function(e){var t=r();return this.bitwiseTo(e,v,t),t},n.prototype.xor=function(e){var t=r();return this.bitwiseTo(e,_,t),t},n.prototype.andNot=function(e){var t=r();return this.bitwiseTo(e,y,t),t},n.prototype.not=function(){for(var e=r(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},n.prototype.shiftLeft=function(e){var t=r();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},n.prototype.shiftRight=function(e){var t=r();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},n.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+m(this[e]);return this.s<0?this.t*this.DB:-1},n.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=S(this[n]^t);return e},n.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},n.prototype.setBit=function(e){return this.changeBit(e,v)},n.prototype.clearBit=function(e){return this.changeBit(e,y)},n.prototype.flipBit=function(e){return this.changeBit(e,_)},n.prototype.add=function(e){var t=r();return this.addTo(e,t),t},n.prototype.subtract=function(e){var t=r();return this.subTo(e,t),t},n.prototype.multiply=function(e){var t=r();return this.multiplyTo(e,t),t},n.prototype.divide=function(e){var t=r();return this.divRemTo(e,t,null),t},n.prototype.remainder=function(e){var t=r();return this.divRemTo(e,null,t),t},n.prototype.divideAndRemainder=function(e){var t=r(),n=r();return this.divRemTo(e,t,n),new Array(t,n)},n.prototype.modPow=function(e,t){var n,o,i=e.bitLength(),s=p(1);if(i<=0)return s;n=i<18?1:i<48?3:i<144?4:i<768?5:6,o=i<8?new f(t):t.isEven()?new k(t):new h(t);var a=new Array,u=3,c=n-1,l=(1<<n)-1;if(a[1]=o.convert(this),n>1){var g=r();for(o.sqrTo(a[1],g);u<=l;)a[u]=r(),o.mulTo(g,a[u-2],a[u]),u+=2}var v,_,y=e.t-1,m=!0,S=r();for(i=d(e[y])-1;y>=0;){for(i>=c?v=e[y]>>i-c&l:(v=(e[y]&(1<<i+1)-1)<<c-i,y>0&&(v|=e[y-1]>>this.DB+i-c)),u=n;0==(1&v);)v>>=1,--u;if((i-=u)<0&&(i+=this.DB,--y),m)a[v].copyTo(s),m=!1;else{for(;u>1;)o.sqrTo(s,S),o.sqrTo(S,s),u-=2;u>0?o.sqrTo(s,S):(_=s,s=S,S=_),o.mulTo(S,a[v],s)}for(;y>=0&&0==(e[y]&1<<i);)o.sqrTo(s,S),_=s,s=S,S=_,--i<0&&(i=this.DB-1,--y)}return o.revert(s)},n.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return n.ZERO;for(var r=e.clone(),o=this.clone(),i=p(1),s=p(0),a=p(0),u=p(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;o.isEven();)o.rShiftTo(1,o),t?(a.isEven()&&u.isEven()||(a.addTo(this,a),u.subTo(e,u)),a.rShiftTo(1,a)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);r.compareTo(o)>=0?(r.subTo(o,r),t&&i.subTo(a,i),s.subTo(u,s)):(o.subTo(r,o),t&&a.subTo(i,a),u.subTo(s,u))}return 0!=o.compareTo(n.ONE)?n.ZERO:u.compareTo(e)>=0?u.subtract(e):u.signum()<0?(u.addTo(e,u),u.signum()<0?u.add(e):u):u},n.prototype.pow=function(e){return this.exp(e,new b)},n.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var o=t.getLowestSetBit(),i=n.getLowestSetBit();if(i<0)return t;for(o<i&&(i=o),i>0&&(t.rShiftTo(i,t),n.rShiftTo(i,n));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=n.getLowestSetBit())>0&&n.rShiftTo(o,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return i>0&&n.lShiftTo(i,n),n},n.prototype.isProbablePrime=function(e){var t,n=this.abs();if(1==n.t&&n[0]<=x[x.length-1]){for(t=0;t<x.length;++t)if(n[0]==x[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<x.length;){for(var r=x[t],o=t+1;o<x.length&&r<R;)r*=x[o++];for(r=n.modInt(r);t<o;)if(r%x[t++]==0)return!1}return n.millerRabin(e)},n.prototype.square=function(){var e=r();return this.squareTo(e),e},n.prototype.Barrett=k,null==T){var O;if(T=new Array,L=0,"undefined"!=typeof window&&window.crypto)if(window.crypto.getRandomValues){var P=new Uint8Array(32);for(window.crypto.getRandomValues(P),O=0;O<32;++O)T[L++]=P[O]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var C=window.crypto.random(32);for(O=0;O<C.length;++O)T[L++]=255&C.charCodeAt(O)}for(;L<N;)O=Math.floor(65536*Math.random()),T[L++]=O>>>8,T[L++]=255&O;L=0,I()}function U(){if(null==E){for(I(),(E=new M).init(T),L=0;L<T.length;++L)T[L]=0;L=0}return E.next()}function j(){}function M(){this.i=0,this.j=0,this.S=new Array}j.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=U()},M.prototype.init=function(e){var t,n,r;for(t=0;t<256;++t)this.S[t]=t;for(n=0,t=0;t<256;++t)n=n+this.S[t]+e[t%e.length]&255,r=this.S[t],this.S[t]=this.S[n],this.S[n]=r;this.i=0,this.j=0},M.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var N=256;e.exports={default:n,BigInteger:n,SecureRandom:j}}).call(this)},function(e,t,n){var r;e.exports=(r=n(119),function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,s=t.algo,a=[],u=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,o=0;o<64;)t(r)&&(o<8&&(a[o]=n(e.pow(r,.5))),u[o]=n(e.pow(r,1/3)),o++),r++}();var c=[],l=s.SHA256=i.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],a=n[4],l=n[5],p=n[6],d=n[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var h=c[f-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,v=c[f-2],_=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[f]=g+c[f-7]+_+c[f-16]}var y=r&o^r&i^o&i,m=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),S=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&p)+u[f]+c[f];d=p,p=l,l=a,a=s+S|0,s=i,i=o,o=r,r=S+(m+y)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+l|0,n[6]=n[6]+p|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),r.SHA256)},function(e,t,n){var r;e.exports=r=r||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},o=r.lib={},i=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var s=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=s<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],o=function(t){t=t;var n=987654321,r=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var a=o(4294967296*(n||e.random()));n=987654071*a(),r.push(4294967296*a()|0)}return new s.init(r,t)}}),a=r.enc={},u=a.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},c=a.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i),u=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,c=e.min(4*u,o);if(u){for(var l=0;l<u;l+=i)this._doProcessBlock(r,l);var p=r.splice(0,u);n.sigBytes-=c}return new s.init(p,c)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(o.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math)},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=c(e),r=n[0],s=n[1],a=new i(function(e,t,n){return 3*(t+n)/4-n}(0,r,s)),u=0,l=s>0?r-4:r,p=0;p<l;p+=4)t=o[e.charCodeAt(p)]<<18|o[e.charCodeAt(p+1)]<<12|o[e.charCodeAt(p+2)]<<6|o[e.charCodeAt(p+3)],a[u++]=t>>16&255,a[u++]=t>>8&255,a[u++]=255&t;return 2===s&&(t=o[e.charCodeAt(p)]<<2|o[e.charCodeAt(p+1)]>>4,a[u++]=255&t),1===s&&(t=o[e.charCodeAt(p)]<<10|o[e.charCodeAt(p+1)]<<4|o[e.charCodeAt(p+2)]>>2,a[u++]=t>>8&255,a[u++]=255&t),a},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],s=0,a=n-o;s<a;s+=16383)i.push(l(e,s,s+16383>a?a:s+16383));return 1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var o,i,s=[],a=t;a<n;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.jws,n=e.KeyUtil,o=e.X509,i=e.crypto,s=e.hextob64u,a=e.b64tohex,u=e.AllowedSigningAlgs;return function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.parseJwt=function e(n){r.Log.debug("JoseUtil.parseJwt");try{var o=t.JWS.parse(n);return{header:o.headerObj,payload:o.payloadObj}}catch(e){r.Log.error(e)}},e.validateJwt=function(t,i,s,u,c,l,p){r.Log.debug("JoseUtil.validateJwt");try{if("RSA"===i.kty)if(i.e&&i.n)i=n.getKey(i);else{if(!i.x5c||!i.x5c.length)return r.Log.error("JoseUtil.validateJwt: RSA key missing key material",i),Promise.reject(new Error("RSA key missing key material"));var d=a(i.x5c[0]);i=o.getPublicKeyFromCertHex(d)}else{if("EC"!==i.kty)return r.Log.error("JoseUtil.validateJwt: Unsupported key type",i&&i.kty),Promise.reject(new Error(i.kty));if(!(i.crv&&i.x&&i.y))return r.Log.error("JoseUtil.validateJwt: EC key missing key material",i),Promise.reject(new Error("EC key missing key material"));i=n.getKey(i)}return e._validateJwt(t,i,s,u,c,l,p)}catch(e){return r.Log.error(e&&e.message||e),Promise.reject("JWT validation failed")}},e.validateJwtAttributes=function(t,n,o,i,s,a){i||(i=0),s||(s=parseInt(Date.now()/1e3));var u=e.parseJwt(t).payload;if(!u.iss)return r.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(u.iss!==n)return r.Log.error("JoseUtil._validateJwt: Invalid issuer in token",u.iss),Promise.reject(new Error("Invalid issuer in token: "+u.iss));if(!u.aud)return r.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(u.aud===o||Array.isArray(u.aud)&&u.aud.indexOf(o)>=0))return r.Log.error("JoseUtil._validateJwt: Invalid audience in token",u.aud),Promise.reject(new Error("Invalid audience in token: "+u.aud));if(u.azp&&u.azp!==o)return r.Log.error("JoseUtil._validateJwt: Invalid azp in token",u.azp),Promise.reject(new Error("Invalid azp in token: "+u.azp));if(!a){var c=s+i,l=s-i;if(!u.iat)return r.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(c<u.iat)return r.Log.error("JoseUtil._validateJwt: iat is in the future",u.iat),Promise.reject(new Error("iat is in the future: "+u.iat));if(u.nbf&&c<u.nbf)return r.Log.error("JoseUtil._validateJwt: nbf is in the future",u.nbf),Promise.reject(new Error("nbf is in the future: "+u.nbf));if(!u.exp)return r.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(u.exp<l)return r.Log.error("JoseUtil._validateJwt: exp is in the past",u.exp),Promise.reject(new Error("exp is in the past:"+u.exp))}return Promise.resolve(u)},e._validateJwt=function(n,o,i,s,a,c,l){return e.validateJwtAttributes(n,i,s,a,c,l).then(function(e){try{return t.JWS.verify(n,o,u)?e:(r.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(e){return r.Log.error(e&&e.message||e),Promise.reject(new Error("signature validation failed"))}})},e.hashString=function e(t,n){try{return i.Util.hashString(t,n)}catch(e){r.Log.error(e)}},e.hexToBase64Url=function e(t){try{return s(t)}catch(e){r.Log.error(e)}},e}()};var r=n(0);e.exports=t.default},function(e,t,n){var r=n(123),o=n(124);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[i+a]=s[a];return t||o(s)}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SigninResponse=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(16);t.SigninResponse=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=o.UrlUtility.parseUrlFragment(t,n);this.error=r.error,this.error_description=r.error_description,this.error_uri=r.error_uri,this.code=r.code,this.state=r.state,this.id_token=r.id_token,this.session_state=r.session_state,this.access_token=r.access_token,this.token_type=r.token_type,this.scope=r.scope,this.profile=void 0,this.expires_in=r.expires_in}return r(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}},set:function(e){var t=parseInt(e);if("number"==typeof t&&t>0){var n=parseInt(Date.now()/1e3);this.expires_at=n+t}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutRequest=void 0;var r=n(0),o=n(16),i=n(38);t.SignoutRequest=function e(t){var n=t.url,s=t.id_token_hint,a=t.post_logout_redirect_uri,u=t.data,c=t.extraQueryParams,l=t.request_type;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!n)throw r.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var p in s&&(n=o.UrlUtility.addQueryParam(n,"id_token_hint",s)),a&&(n=o.UrlUtility.addQueryParam(n,"post_logout_redirect_uri",a),u&&(this.state=new i.State({data:u,request_type:l}),n=o.UrlUtility.addQueryParam(n,"state",this.state.id))),c)n=o.UrlUtility.addQueryParam(n,p,c[p]);this.url=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutResponse=void 0;var r=n(16);t.SignoutResponse=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=r.UrlUtility.parseUrlFragment(t,"?");this.error=n.error,this.error_description=n.error_description,this.error_uri=n.error_uri,this.state=n.state}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryWebStorage=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0);t.InMemoryWebStorage=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return e.prototype.getItem=function(e){return o.Log.debug("InMemoryWebStorage.getItem",e),this._data[e]},e.prototype.setItem=function(e,t){o.Log.debug("InMemoryWebStorage.setItem",e),this._data[e]=t},e.prototype.removeItem=function(e){o.Log.debug("InMemoryWebStorage.removeItem",e),delete this._data[e]},e.prototype.key=function(e){return Object.getOwnPropertyNames(this._data)[e]},r(e,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=n(49),s=n(130),a=n(55),u=n(136),c=n(138),l=n(58),p=n(60),d=n(50),f=n(20);t.UserManager=function(e){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.SilentRenewService,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.SessionMonitor,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p.TokenRevocationClient,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:d.TokenClient,g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:f.JoseUtil;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n instanceof s.UserManagerSettings||(n=new s.UserManagerSettings(n));var v=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return v._events=new u.UserManagerEvents(n),v._silentRenewService=new r(v),v.settings.automaticSilentRenew&&(o.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),v.startSilentRenew()),v.settings.monitorSession&&(o.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),v._sessionMonitor=new i(v)),v._tokenRevocationClient=new a(v._settings),v._tokenClient=new h(v._settings),v._joseUtil=g,v}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getUser=function(){var e=this;return this._loadUser().then(function(t){return t?(o.Log.info("UserManager.getUser: user loaded"),e._events.load(t,!1),t):(o.Log.info("UserManager.getUser: user not found in storage"),null)})},t.prototype.removeUser=function(){var e=this;return this.storeUser(null).then(function(){o.Log.info("UserManager.removeUser: user removed from storage"),e._events.unload()})},t.prototype.signinRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:r";var t={useReplaceToNavigate:e.useReplaceToNavigate};return this._signinStart(e,this._redirectNavigator,t).then(function(){o.Log.info("UserManager.signinRedirect: successful")})},t.prototype.signinRedirectCallback=function(e){return this._signinEnd(e||this._redirectNavigator.url).then(function(e){return e.profile&&e.profile.sub?o.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",e.profile.sub):o.Log.info("UserManager.signinRedirectCallback: no sub"),e})},t.prototype.signinPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:p";var t=e.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.display="popup",this._signin(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then(function(e){return e&&(e.profile&&e.profile.sub?o.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",e.profile.sub):o.Log.info("UserManager.signinPopup: no sub")),e})):(o.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},t.prototype.signinPopupCallback=function(e){return this._signinCallback(e,this._popupNavigator).then(function(e){return e&&(e.profile&&e.profile.sub?o.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",e.profile.sub):o.Log.info("UserManager.signinPopupCallback: no sub")),e}).catch(function(e){o.Log.error(e.message)})},t.prototype.signinSilent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t=Object.assign({},t)).request_type="si:s",this._loadUser().then(function(n){return n&&n.refresh_token?(t.refresh_token=n.refresh_token,e._useRefreshToken(t)):(t.id_token_hint=t.id_token_hint||e.settings.includeIdTokenInSilentRenew&&n&&n.id_token,n&&e._settings.validateSubOnSilentRenew&&(o.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",n.profile.sub),t.current_sub=n.profile.sub),e._signinSilentIframe(t))})},t.prototype._useRefreshToken=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._tokenClient.exchangeRefreshToken(t).then(function(t){return t?t.access_token?e._loadUser().then(function(n){if(n){var r=Promise.resolve();return t.id_token&&(r=e._validateIdTokenFromTokenRefreshToken(n.profile,t.id_token)),r.then(function(){return o.Log.debug("UserManager._useRefreshToken: refresh token response success"),n.id_token=t.id_token,n.access_token=t.access_token,n.refresh_token=t.refresh_token||n.refresh_token,n.expires_in=t.expires_in,e.storeUser(n).then(function(){return e._events.load(n),n})})}return null}):(o.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(o.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))})},t.prototype._validateIdTokenFromTokenRefreshToken=function(e,t){var n=this;return this._metadataService.getIssuer().then(function(r){return n._joseUtil.validateJwtAttributes(t,r,n._settings.client_id,n._settings.clockSkew).then(function(t){return t?t.sub!==e.sub?(o.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):t.auth_time&&t.auth_time!==e.auth_time?(o.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):t.azp&&t.azp!==e.azp?(o.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!t.azp&&e.azp?(o.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(o.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))})})},t.prototype._signinSilentIframe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.prompt=e.prompt||"none",this._signin(e,this._iframeNavigator,{startUrl:t,silentRequestTimeout:e.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(e){return e&&(e.profile&&e.profile.sub?o.Log.info("UserManager.signinSilent: successful, signed in sub: ",e.profile.sub):o.Log.info("UserManager.signinSilent: no sub")),e})):(o.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype.signinSilentCallback=function(e){return this._signinCallback(e,this._iframeNavigator).then(function(e){return e&&(e.profile&&e.profile.sub?o.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",e.profile.sub):o.Log.info("UserManager.signinSilentCallback: no sub")),e})},t.prototype.signinCallback=function(e){var t=this;return this.readSigninResponseState(e).then(function(n){var r=n.state;return n.response,"si:r"===r.request_type?t.signinRedirectCallback(e):"si:p"===r.request_type?t.signinPopupCallback(e):"si:s"===r.request_type?t.signinSilentCallback(e):Promise.reject(new Error("invalid response_type in state"))})},t.prototype.signoutCallback=function(e,t){var n=this;return this.readSignoutResponseState(e).then(function(r){var o=r.state,i=r.response;return o?"so:r"===o.request_type?n.signoutRedirectCallback(e):"so:p"===o.request_type?n.signoutPopupCallback(e,t):Promise.reject(new Error("invalid response_type in state")):i})},t.prototype.querySessionStatus=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).request_type="si:s";var n=t.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return n?(t.redirect_uri=n,t.prompt="none",t.response_type=t.response_type||this.settings.query_status_response_type,t.scope=t.scope||"openid",t.skipUserInfo=!0,this._signinStart(t,this._iframeNavigator,{startUrl:n,silentRequestTimeout:t.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(t){return e.processSigninResponse(t.url).then(function(e){if(o.Log.debug("UserManager.querySessionStatus: got signin response"),e.session_state&&e.profile.sub)return o.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid};o.Log.info("querySessionStatus successful, user not authenticated")}).catch(function(t){if(t.session_state&&e.settings.monitorAnonymousSession&&("login_required"==t.message||"consent_required"==t.message||"interaction_required"==t.message||"account_selection_required"==t.message))return o.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:t.session_state};throw t})})):(o.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype._signin=function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signinStart(e,t,r).then(function(t){return n._signinEnd(t.url,e)})},t.prototype._signinStart=function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.prepare(r).then(function(t){return o.Log.debug("UserManager._signinStart: got navigator window handle"),n.createSigninRequest(e).then(function(e){return o.Log.debug("UserManager._signinStart: got signin request"),r.url=e.url,r.id=e.state.id,t.navigate(r)}).catch(function(e){throw t.close&&(o.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),t.close()),e})})},t.prototype._signinEnd=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.processSigninResponse(e).then(function(e){o.Log.debug("UserManager._signinEnd: got signin response");var r=new a.User(e);if(n.current_sub){if(n.current_sub!==r.profile.sub)return o.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",r.profile.sub),Promise.reject(new Error("login_required"));o.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return t.storeUser(r).then(function(){return o.Log.debug("UserManager._signinEnd: user stored"),t._events.load(r),r})})},t.prototype._signinCallback=function(e,t){return o.Log.debug("UserManager._signinCallback"),t.callback(e)},t.prototype.signoutRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="so:r";var t=e.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;t&&(e.post_logout_redirect_uri=t);var n={useReplaceToNavigate:e.useReplaceToNavigate};return this._signoutStart(e,this._redirectNavigator,n).then(function(){o.Log.info("UserManager.signoutRedirect: successful")})},t.prototype.signoutRedirectCallback=function(e){return this._signoutEnd(e||this._redirectNavigator.url).then(function(e){return o.Log.info("UserManager.signoutRedirectCallback: successful"),e})},t.prototype.signoutPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="so:p";var t=e.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return e.post_logout_redirect_uri=t,e.display="popup",e.post_logout_redirect_uri&&(e.state=e.state||{}),this._signout(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then(function(){o.Log.info("UserManager.signoutPopup: successful")})},t.prototype.signoutPopupCallback=function(e,t){return void 0===t&&"boolean"==typeof e&&(t=e,e=null),this._popupNavigator.callback(e,t,"?").then(function(){o.Log.info("UserManager.signoutPopupCallback: successful")})},t.prototype._signout=function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signoutStart(e,t,r).then(function(e){return n._signoutEnd(e.url)})},t.prototype._signoutStart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.prepare(r).then(function(n){return o.Log.debug("UserManager._signoutStart: got navigator window handle"),t._loadUser().then(function(i){return o.Log.debug("UserManager._signoutStart: loaded current user from storage"),(t._settings.revokeAccessTokenOnSignout?t._revokeInternal(i):Promise.resolve()).then(function(){var s=e.id_token_hint||i&&i.id_token;return s&&(o.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),e.id_token_hint=s),t.removeUser().then(function(){return o.Log.debug("UserManager._signoutStart: user removed, creating signout request"),t.createSignoutRequest(e).then(function(e){return o.Log.debug("UserManager._signoutStart: got signout request"),r.url=e.url,e.state&&(r.id=e.state.id),n.navigate(r)})})})}).catch(function(e){throw n.close&&(o.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),n.close()),e})})},t.prototype._signoutEnd=function(e){return this.processSignoutResponse(e).then(function(e){return o.Log.debug("UserManager._signoutEnd: got signout response"),e})},t.prototype.revokeAccessToken=function(){var e=this;return this._loadUser().then(function(t){return e._revokeInternal(t,!0).then(function(n){if(n)return o.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),t.access_token=null,t.refresh_token=null,t.expires_at=null,t.token_type=null,e.storeUser(t).then(function(){o.Log.debug("UserManager.revokeAccessToken: user stored"),e._events.load(t)})})}).then(function(){o.Log.info("UserManager.revokeAccessToken: access token revoked successfully")})},t.prototype._revokeInternal=function(e,t){var n=this;if(e){var r=e.access_token,i=e.refresh_token;return this._revokeAccessTokenInternal(r,t).then(function(e){return n._revokeRefreshTokenInternal(i,t).then(function(t){return e||t||o.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),e||t})})}return Promise.resolve(!1)},t.prototype._revokeAccessTokenInternal=function(e,t){return!e||e.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(e,t).then(function(){return!0})},t.prototype._revokeRefreshTokenInternal=function(e,t){return e?this._tokenRevocationClient.revoke(e,t,"refresh_token").then(function(){return!0}):Promise.resolve(!1)},t.prototype.startSilentRenew=function(){this._silentRenewService.start()},t.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},t.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then(function(e){return e?(o.Log.debug("UserManager._loadUser: user storageString loaded"),a.User.fromStorageString(e)):(o.Log.debug("UserManager._loadUser: no user storageString"),null)})},t.prototype.storeUser=function(e){if(e){o.Log.debug("UserManager.storeUser: storing user");var t=e.toStorageString();return this._userStore.set(this._userStoreKey,t)}return o.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},r(t,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),t}(i.OidcClient)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerSettings=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(n(0),n(35)),i=n(131),s=n(132),a=n(134),u=n(36),c=n(4),l=n(52),p=60,d=2e3;t.UserManagerSettings=function(e){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.popup_redirect_uri,o=n.popup_post_logout_redirect_uri,f=n.popupWindowFeatures,h=n.popupWindowTarget,g=n.silent_redirect_uri,v=n.silentRequestTimeout,_=n.automaticSilentRenew,y=void 0!==_&&_,m=n.validateSubOnSilentRenew,S=void 0!==m&&m,b=n.includeIdTokenInSilentRenew,w=void 0===b||b,k=n.monitorSession,E=void 0===k||k,T=n.monitorAnonymousSession,L=void 0!==T&&T,x=n.checkSessionInterval,R=void 0===x?d:x,I=n.stopCheckSessionOnError,O=void 0===I||I,P=n.query_status_response_type,C=n.revokeAccessTokenOnSignout,U=void 0!==C&&C,j=n.accessTokenExpiringNotificationTime,M=void 0===j?p:j,N=n.redirectNavigator,A=void 0===N?new i.RedirectNavigator:N,W=n.popupNavigator,D=void 0===W?new s.PopupNavigator:W,F=n.iframeNavigator,q=void 0===F?new a.IFrameNavigator:F,B=n.userStore,V=void 0===B?new u.WebStorageStateStore({store:c.Global.sessionStorage}):B;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var J=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,arguments[0]));return J._popup_redirect_uri=r,J._popup_post_logout_redirect_uri=o,J._popupWindowFeatures=f,J._popupWindowTarget=h,J._silent_redirect_uri=g,J._silentRequestTimeout=v,J._automaticSilentRenew=y,J._validateSubOnSilentRenew=S,J._includeIdTokenInSilentRenew=w,J._accessTokenExpiringNotificationTime=M,J._monitorSession=E,J._monitorAnonymousSession=L,J._checkSessionInterval=R,J._stopCheckSessionOnError=O,P?J._query_status_response_type=P:arguments[0]&&arguments[0].response_type?J._query_status_response_type=l.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":J._query_status_response_type="id_token",J._revokeAccessTokenOnSignout=U,J._redirectNavigator=A,J._popupNavigator=D,J._iframeNavigator=q,J._userStore=V,J}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),t}(o.OidcClientSettings)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectNavigator=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0);t.RedirectNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(){return Promise.resolve(this)},e.prototype.navigate=function(e){return e&&e.url?(e.useReplaceToNavigate?window.location.replace(e.url):window.location=e.url,Promise.resolve()):(o.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},r(e,[{key:"url",get:function(){return window.location.href}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupNavigator=void 0;var r=n(0),o=n(133);t.PopupNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new o.PopupWindow(e);return Promise.resolve(t)},e.prototype.callback=function e(t,n,i){r.Log.debug("PopupNavigator.callback");try{return o.PopupWindow.notifyOpener(t,n,i),Promise.resolve()}catch(e){return Promise.reject(e)}},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupWindow=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=n(16),s=500,a="location=no,toolbar=no,width=500,height=500,left=100,top=100;",u="_blank";t.PopupWindow=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise(function(e,t){n._resolve=e,n._reject=t});var r=t.popupWindowTarget||u,i=t.popupWindowFeatures||a;this._popup=window.open("",r,i),this._popup&&(o.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),s))}return e.prototype.navigate=function(e){return this._popup?e&&e.url?(o.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=e.id,this._id&&(window["popupCallback_"+e.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=e.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},e.prototype._success=function(e){o.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(e)},e.prototype._error=function(e){o.Log.error("PopupWindow.error: ",e),this._cleanup(),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup(!1)},e.prototype._cleanup=function(e){o.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!e&&this._popup.close(),this._popup=null},e.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},e.prototype._callback=function(e,t){this._cleanup(t),e?(o.Log.debug("PopupWindow.callback success"),this._success({url:e})):(o.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},e.notifyOpener=function(e,t,n){if(window.opener){if(e=e||window.location.href){var r=i.UrlUtility.parseUrlFragment(e,n);if(r.state){var s="popupCallback_"+r.state,a=window.opener[s];a?(o.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),a(e,t)):o.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else o.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else o.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},r(e,[{key:"promise",get:function(){return this._promise}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameNavigator=void 0;var r=n(0),o=n(135);t.IFrameNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new o.IFrameWindow(e);return Promise.resolve(t)},e.prototype.callback=function e(t){r.Log.debug("IFrameNavigator.callback");try{return o.IFrameWindow.notifyParent(t),Promise.resolve()}catch(e){return Promise.reject(e)}},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameWindow=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0);t.IFrameWindow=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise(function(e,t){n._resolve=e,n._reject=t}),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.style.width=0,this._frame.style.height=0,window.document.body.appendChild(this._frame)}return e.prototype.navigate=function(e){if(e&&e.url){var t=e.silentRequestTimeout||1e4;o.Log.debug("IFrameWindow.navigate: Using timeout of:",t),this._timer=window.setTimeout(this._timeout.bind(this),t),this._frame.src=e.url}else this._error("No url provided");return this.promise},e.prototype._success=function(e){this._cleanup(),o.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),o.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._frame&&(o.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},e.prototype._timeout=function(){o.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},e.prototype._message=function(e){if(o.Log.debug("IFrameWindow.message"),this._timer&&e.origin===this._origin&&e.source===this._frame.contentWindow){var t=e.data;t?this._success({url:t}):this._error("Invalid response from frame")}},e.notifyParent=function(e){o.Log.debug("IFrameWindow.notifyParent"),window.frameElement&&(e=e||window.location.href)&&(o.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(e,location.protocol+"//"+location.host))},r(e,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerEvents=void 0;var r=n(0),o=n(56),i=n(57);t.UserManagerEvents=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return r._userLoaded=new i.Event("User loaded"),r._userUnloaded=new i.Event("User unloaded"),r._silentRenewError=new i.Event("Silent renew error"),r._userSignedIn=new i.Event("User signed in"),r._userSignedOut=new i.Event("User signed out"),r._userSessionChanged=new i.Event("User session changed"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.load=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r.Log.debug("UserManagerEvents.load"),e.prototype.load.call(this,t),n&&this._userLoaded.raise(t)},t.prototype.unload=function(){r.Log.debug("UserManagerEvents.unload"),e.prototype.unload.call(this),this._userUnloaded.raise()},t.prototype.addUserLoaded=function(e){this._userLoaded.addHandler(e)},t.prototype.removeUserLoaded=function(e){this._userLoaded.removeHandler(e)},t.prototype.addUserUnloaded=function(e){this._userUnloaded.addHandler(e)},t.prototype.removeUserUnloaded=function(e){this._userUnloaded.removeHandler(e)},t.prototype.addSilentRenewError=function(e){this._silentRenewError.addHandler(e)},t.prototype.removeSilentRenewError=function(e){this._silentRenewError.removeHandler(e)},t.prototype._raiseSilentRenewError=function(e){r.Log.debug("UserManagerEvents._raiseSilentRenewError",e.message),this._silentRenewError.raise(e)},t.prototype.addUserSignedIn=function(e){this._userSignedIn.addHandler(e)},t.prototype.removeUserSignedIn=function(e){this._userSignedIn.removeHandler(e)},t.prototype._raiseUserSignedIn=function(){r.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},t.prototype.addUserSignedOut=function(e){this._userSignedOut.addHandler(e)},t.prototype.removeUserSignedOut=function(e){this._userSignedOut.removeHandler(e)},t.prototype._raiseUserSignedOut=function(){r.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},t.prototype.addUserSessionChanged=function(e){this._userSessionChanged.addHandler(e)},t.prototype.removeUserSessionChanged=function(e){this._userSessionChanged.removeHandler(e)},t.prototype._raiseUserSessionChanged=function(){r.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},t}(o.AccessTokenEvents)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),i=n(4),s=n(57);t.Timer=function(e){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Global.timer,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return s._timer=r,s._nowFunc=o||function(){return Date.now()/1e3},s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.init=function(e){e<=0&&(e=1),e=parseInt(e);var t=this.now+e;if(this.expiration===t&&this._timerHandle)o.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),o.Log.debug("Timer.init timer "+this._name+" for duration:",e),this._expiration=t;var n=5;e<n&&(n=e),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*n)}},t.prototype.cancel=function(){this._timerHandle&&(o.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},t.prototype._callback=function(){var t=this._expiration-this.now;o.Log.debug("Timer.callback; "+this._name+" timer expires in:",t),this._expiration<=this.now&&(this.cancel(),e.prototype.raise.call(this))},r(t,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),t}(s.Event)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SilentRenewService=void 0;var r=n(0);t.SilentRenewService=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userManager=t}return e.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then(function(e){}).catch(function(e){r.Log.error("SilentRenewService.start: Error from getUser:",e.message)}))},e.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},e.prototype._tokenExpiring=function(){var e=this;this._userManager.signinSilent().then(function(e){r.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")},function(t){r.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",t.message),e._userManager.events._raiseSilentRenewError(t)})},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupNavigator=void 0;var r=n(61);t.CordovaPopupNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new r.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaIFrameNavigator=void 0;var r=n(61);t.CordovaIFrameNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){e.popupWindowFeatures="hidden=yes";var t=new r.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.10.1"}]),Sentry=function(e){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,n)};function n(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r,o,i,s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e}!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Debug=2]="Debug",e[e.Verbose=3]="Verbose"}(r||(r={})),(o=e.Severity||(e.Severity={})).Fatal="fatal",o.Error="error",o.Warning="warning",o.Log="log",o.Info="info",o.Debug="debug",o.Critical="critical",function(e){e.fromString=function(t){switch(t){case"debug":return e.Debug;case"info":return e.Info;case"warn":case"warning":return e.Warning;case"error":return e.Error;case"fatal":return e.Fatal;case"critical":return e.Critical;case"log":default:return e.Log}}}(e.Severity||(e.Severity={})),(i=e.Status||(e.Status={})).Unknown="unknown",i.Skipped="skipped",i.Success="success",i.RateLimit="rate_limit",i.Invalid="invalid",i.Failed="failed",function(e){e.fromHttpCode=function(t){return t>=200&&t<300?e.Success:429===t?e.RateLimit:t>=400&&t<500?e.Invalid:t>=500?e.Failed:e.Unknown}}(e.Status||(e.Status={}));var c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);return e}),l=function(e){function t(t){var n=this.constructor,r=e.call(this,t)||this;return r.message=t,r.name=n.prototype.constructor.name,c(r,n.prototype),r}return n(t,e),t}(Error);function p(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}}function d(e){return"[object ErrorEvent]"===Object.prototype.toString.call(e)}function f(e){return"[object DOMError]"===Object.prototype.toString.call(e)}function h(e){return"[object String]"===Object.prototype.toString.call(e)}function g(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function v(e){return"[object Object]"===Object.prototype.toString.call(e)}function _(e){return Boolean(e&&e.then&&"function"==typeof e.then)}var y={};function m(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:y}function S(){var e=m(),t=e.crypto||e.msCrypto;if(void 0!==t&&t.getRandomValues){var n=new Uint16Array(8);t.getRandomValues(n),n[3]=4095&n[3]|16384,n[4]=16383&n[4]|32768;var r=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return r(n[0])+r(n[1])+r(n[2])+r(n[3])+r(n[4])+r(n[5])+r(n[6])+r(n[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function b(e){if(!e)return{};var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],relative:t[5]+n+r}}function w(e){if(e.message)return e.message;if(e.exception&&e.exception.values&&e.exception.values[0]){var t=e.exception.values[0];return t.type&&t.value?t.type+": "+t.value:t.type||t.value||e.event_id||"<unknown>"}return e.event_id||"<unknown>"}function k(e){var t=m();if(!("console"in t))return e();var n=t.console,r={};["debug","info","warn","error","log","assert"].forEach(function(e){e in t.console&&n[e].__sentry__&&(r[e]=n[e].__sentry_wrapped__,n[e]=n[e].__sentry_original__)});var o=e();return Object.keys(r).forEach(function(e){n[e]=r[e]}),o}function E(e,t,n,r){void 0===r&&(r={handled:!0,type:"generic"}),e.exception=e.exception||{},e.exception.values=e.exception.values||[],e.exception.values[0]=e.exception.values[0]||{},e.exception.values[0].value=e.exception.values[0].value||t||"",e.exception.values[0].type=e.exception.values[0].type||n||"Error",e.exception.values[0].mechanism=e.exception.values[0].mechanism||r}var T=m(),L="Sentry Logger ",x=function(){function e(){this.t=!1}return e.prototype.disable=function(){this.t=!1},e.prototype.enable=function(){this.t=!0},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.t&&k(function(){T.console.log(L+"[Log]: "+e.join(" "))})},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.t&&k(function(){T.console.warn(L+"[Warn]: "+e.join(" "))})},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.t&&k(function(){T.console.error(L+"[Error]: "+e.join(" "))})},e}();T.__SENTRY__=T.__SENTRY__||{};var R=T.__SENTRY__.logger||(T.__SENTRY__.logger=new x),I=function(){function e(){this.i="function"==typeof WeakSet,this.o=this.i?new WeakSet:[]}return e.prototype.memoize=function(e){if(this.i)return!!this.o.has(e)||(this.o.add(e),!1);for(var t=0;t<this.o.length;t++)if(this.o[t]===e)return!0;return this.o.push(e),!1},e.prototype.unmemoize=function(e){if(this.i)this.o.delete(e);else for(var t=0;t<this.o.length;t++)if(this.o[t]===e){this.o.splice(t,1);break}},e}();function O(e,t,n){if(t in e){var r=e[t],o=n(r);if("function"==typeof o)try{o.prototype=o.prototype||{},Object.defineProperties(o,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:r},__sentry_wrapped__:{enumerable:!1,value:o}})}catch(e){}e[t]=o}}function P(e,t,n){void 0===t&&(t=3),void 0===n&&(n=102400);var r=U(e,t);return function(e){return function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(e))}(r)>n?P(e,t-1,n):r}function C(e,t){return"domain"===t&&"object"==typeof e&&e.u?"[Domain]":"domainEmitter"===t?"[DomainEmitter]":"undefined"!=typeof global&&e===global?"[Global]":"undefined"!=typeof window&&e===window?"[Window]":"undefined"!=typeof document&&e===document?"[Document]":"undefined"!=typeof Event&&e instanceof Event?Object.getPrototypeOf(e)?e.constructor.name:"Event":v(n=e)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n?"[SyntheticEvent]":Number.isNaN(e)?"[NaN]":void 0===e?"[undefined]":"function"==typeof e?"[Function: "+(e.name||"<unknown-function-name>")+"]":e;var n}function U(e,t){try{return JSON.parse(JSON.stringify(e,function(e,n){return function e(t,n,r,o){if(void 0===r&&(r=1/0),void 0===o&&(o=new I),0===r)return function(e){var t=Object.prototype.toString.call(e);if("string"==typeof e)return e;if("[object Object]"===t)return"[Object]";if("[object Array]"===t)return"[Array]";var n=C(e);return g(n)?n:t}(n);if(null!=n&&"function"==typeof n.toJSON)return n.toJSON();var i=C(n,t);if(g(i))return i;var s=p(n)?function(e){var t={message:e.message,name:e.name,stack:e.stack};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}(n):n,a=Array.isArray(n)?[]:{};if(o.memoize(n))return"[Circular ~]";for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(a[u]=e(u,s[u],r-1,o));return o.unmemoize(n),a}(e,n,t)}))}catch(e){return"**non-serializable**"}}var j,M=function(){function e(e){this.s=e,this.h=[]}return e.prototype.isReady=function(){return void 0===this.s||this.length()<this.s},e.prototype.add=function(e){var t=this;return this.isReady()?(-1===this.h.indexOf(e)&&this.h.push(e),e.then(function(){return t.remove(e)}).catch(function(){return t.remove(e).catch(function(){})}),e):Promise.reject(new l("Not adding Promise due to buffer limit reached."))},e.prototype.remove=function(e){return this.h.splice(this.h.indexOf(e),1)[0]},e.prototype.length=function(){return this.h.length},e.prototype.drain=function(e){var t=this;return new Promise(function(n){var r=setTimeout(function(){e&&e>0&&n(!1)},e);Promise.all(t.h).then(function(){clearTimeout(r),n(!0)}).catch(function(){n(!0)})})},e}();function N(e,t){return void 0===t&&(t=0),"string"!=typeof e||0===t?e:e.length<=t?e:e.substr(0,t)+"..."}function A(e,t){if(!Array.isArray(e))return"";for(var n=[],r=0;r<e.length;r++){var o=e[r];try{n.push(String(o))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function W(e,t){return n=t,"[object RegExp]"===Object.prototype.toString.call(n)?t.test(e):"string"==typeof t&&e.includes(t);var n}function D(){if(!("fetch"in m()))return!1;try{return new Headers,new Request(""),new Response,!0}catch(e){return!1}}!function(e){e.PENDING="PENDING",e.RESOLVED="RESOLVED",e.REJECTED="REJECTED"}(j||(j={}));var F=function(){function e(e){var t=this;this.l=j.PENDING,this.v=[],this.p=function(e){t.m(e,j.RESOLVED)},this.g=function(e){t.m(e,j.REJECTED)},this.m=function(e,n){t.l===j.PENDING&&(_(e)?e.then(t.p,t.g):(t.j=e,t.l=n,t._()))},this._=function(){t.l!==j.PENDING&&(t.l===j.REJECTED?t.v.forEach(function(e){return e.onFail&&e.onFail(t.j)}):t.v.forEach(function(e){return e.onSuccess&&e.onSuccess(t.j)}),t.v=[])},this.S=function(e){t.v=t.v.concat(e),t._()};try{e(this.p,this.g)}catch(e){this.g(e)}}return e.prototype.then=function(t,n){var r=this;return new e(function(e,o){r.S({onFail:function(t){if(n)try{return void e(n(t))}catch(e){return void o(e)}else o(t)},onSuccess:function(n){if(t)try{return void e(t(n))}catch(e){return void o(e)}else e(n)}})})},e.prototype.catch=function(e){return this.then(function(e){return e},e)},e.prototype.toString=function(){return"[object SyncPromise]"},e.resolve=function(t){return new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e}(),q=/^[ \t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \t]*$/,B=function(){function e(e,t,n,r){void 0===e&&(e=S()),void 0===t&&(t=S().substring(16)),this.O=e,this.k=t,this.T=n,this.R=r}return e.prototype.setParent=function(e){return this.R=e,this},e.prototype.setSampled=function(e){return this.T=e,this},e.fromTraceparent=function(t){var n=t.match(q);if(n){var r=void 0;"1"===n[3]?r=!0:"0"===n[3]&&(r=!1);var o=new e(n[1],n[2],r);return new e(n[1],void 0,r,o)}},e.prototype.toTraceparent=function(){var e="";return!0===this.T?e="-1":!1===this.T&&(e="-0"),this.O+"-"+this.k+e},e.prototype.toJSON=function(){return{parent:this.R&&this.R.toJSON()||void 0,sampled:this.T,span_id:this.k,trace_id:this.O}},e}(),V=function(){function e(){this.D=!1,this.I=[],this.C=[],this.N=[],this.A={},this.L={},this.M={},this.U={}}return e.prototype.addScopeListener=function(e){this.I.push(e)},e.prototype.addEventProcessor=function(e){return this.C.push(e),this},e.prototype.F=function(){var e=this;this.D||(this.D=!0,setTimeout(function(){e.I.forEach(function(t){t(e)}),e.D=!1}))},e.prototype.P=function(e,t,n,r){var o=this;return void 0===r&&(r=0),new F(function(i,a){var u=e[r];if(null===t||"function"!=typeof u)i(t);else{var c=u(s({},t),n);_(c)?c.then(function(t){return o.P(e,t,n,r+1).then(i)}).catch(a):o.P(e,c,n,r+1).then(i).catch(a)}})},e.prototype.setUser=function(e){return this.A=U(e),this.F(),this},e.prototype.setTags=function(e){return this.L=s({},this.L,U(e)),this.F(),this},e.prototype.setTag=function(e,t){var n;return this.L=s({},this.L,((n={})[e]=U(t),n)),this.F(),this},e.prototype.setExtras=function(e){return this.M=s({},this.M,U(e)),this.F(),this},e.prototype.setExtra=function(e,t){var n;return this.M=s({},this.M,((n={})[e]=U(t),n)),this.F(),this},e.prototype.setFingerprint=function(e){return this.$=U(e),this.F(),this},e.prototype.setLevel=function(e){return this.q=U(e),this.F(),this},e.prototype.setTransaction=function(e){return this.H=e,this.F(),this},e.prototype.setContext=function(e,t){return this.U[e]=t?U(t):void 0,this.F(),this},e.prototype.setSpan=function(e){return this.W=e,this.F(),this},e.prototype.startSpan=function(e){var t=new B;return t.setParent(e),this.setSpan(t),t},e.prototype.getSpan=function(){return this.W},e.clone=function(t){var n=new e;return Object.assign(n,t,{I:[]}),t&&(n.N=u(t.N),n.L=s({},t.L),n.M=s({},t.M),n.U=s({},t.U),n.A=t.A,n.q=t.q,n.W=t.W,n.H=t.H,n.$=t.$,n.C=u(t.C)),n},e.prototype.clear=function(){return this.N=[],this.L={},this.M={},this.A={},this.U={},this.q=void 0,this.H=void 0,this.$=void 0,this.W=void 0,this.F(),this},e.prototype.addBreadcrumb=function(e,t){var n=(new Date).getTime()/1e3,r=s({timestamp:n},e);return this.N=void 0!==t&&t>=0?u(this.N,[U(r)]).slice(-t):u(this.N,[U(r)]),this.F(),this},e.prototype.clearBreadcrumbs=function(){return this.N=[],this.F(),this},e.prototype.B=function(e){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],this.$&&(e.fingerprint=e.fingerprint.concat(this.$)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint},e.prototype.applyToEvent=function(e,t){return this.M&&Object.keys(this.M).length&&(e.extra=s({},this.M,e.extra)),this.L&&Object.keys(this.L).length&&(e.tags=s({},this.L,e.tags)),this.A&&Object.keys(this.A).length&&(e.user=s({},this.A,e.user)),this.U&&Object.keys(this.U).length&&(e.contexts=s({},this.U,e.contexts)),this.q&&(e.level=this.q),this.H&&(e.transaction=this.H),this.W&&(e.contexts=e.contexts||{},e.contexts.trace=this.W),this.B(e),e.breadcrumbs=u(e.breadcrumbs||[],this.N),e.breadcrumbs=e.breadcrumbs.length>0?e.breadcrumbs:void 0,this.P(u(J(),this.C),e,t)},e}();function J(){var e=m();return e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.globalEventProcessors=e.__SENTRY__.globalEventProcessors||[],e.__SENTRY__.globalEventProcessors}function H(e){J().push(e)}var G=3,z=function(){function e(e,t,n){void 0===t&&(t=new V),void 0===n&&(n=G),this.J=n,this.X=[],this.X.push({client:e,scope:t})}return e.prototype.G=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.getStackTop();o&&o.client&&o.client[e]&&(t=o.client)[e].apply(t,u(n,[o.scope]))},e.prototype.isOlderThan=function(e){return this.J<e},e.prototype.bindClient=function(e){this.getStackTop().client=e},e.prototype.pushScope=function(){var e=this.getStack(),t=e.length>0?e[e.length-1].scope:void 0,n=V.clone(t);return this.getStack().push({client:this.getClient(),scope:n}),n},e.prototype.popScope=function(){return void 0!==this.getStack().pop()},e.prototype.withScope=function(e){var t=this.pushScope();try{e(t)}finally{this.popScope()}},e.prototype.getClient=function(){return this.getStackTop().client},e.prototype.getScope=function(){return this.getStackTop().scope},e.prototype.getStack=function(){return this.X},e.prototype.getStackTop=function(){return this.X[this.X.length-1]},e.prototype.captureException=function(e,t){var n=this.V=S(),r=t;if(!t){var o=void 0;try{throw new Error("Sentry syntheticException")}catch(e){o=e}r={originalException:e,syntheticException:o}}return this.G("captureException",e,s({},r,{event_id:n})),n},e.prototype.captureMessage=function(e,t,n){var r=this.V=S(),o=n;if(!n){var i=void 0;try{throw new Error(e)}catch(e){i=e}o={originalException:e,syntheticException:i}}return this.G("captureMessage",e,t,s({},o,{event_id:r})),r},e.prototype.captureEvent=function(e,t){var n=this.V=S();return this.G("captureEvent",e,s({},t,{event_id:n})),n},e.prototype.lastEventId=function(){return this.V},e.prototype.addBreadcrumb=function(e,t){var n=this.getStackTop();if(n.scope&&n.client){var r=n.client.getOptions&&n.client.getOptions()||{},o=r.beforeBreadcrumb,i=void 0===o?null:o,a=r.maxBreadcrumbs,u=void 0===a?30:a;if(!(u<=0)){var c=(new Date).getTime()/1e3,l=s({timestamp:c},e),p=i?k(function(){return i(l,t)}):l;null!==p&&n.scope.addBreadcrumb(p,Math.min(u,100))}}},e.prototype.setUser=function(e){var t=this.getStackTop();t.scope&&t.scope.setUser(e)},e.prototype.setTags=function(e){var t=this.getStackTop();t.scope&&t.scope.setTags(e)},e.prototype.setExtras=function(e){var t=this.getStackTop();t.scope&&t.scope.setExtras(e)},e.prototype.setTag=function(e,t){var n=this.getStackTop();n.scope&&n.scope.setTag(e,t)},e.prototype.setExtra=function(e,t){var n=this.getStackTop();n.scope&&n.scope.setExtra(e,t)},e.prototype.setContext=function(e,t){var n=this.getStackTop();n.scope&&n.scope.setContext(e,t)},e.prototype.configureScope=function(e){var t=this.getStackTop();t.scope&&t.client&&e(t.scope)},e.prototype.run=function(e){var t=Y(this);try{e(this)}finally{Y(t)}},e.prototype.getIntegration=function(e){var t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return R.warn("Cannot retrieve integration "+e.id+" from the current Hub"),null}},e.prototype.traceHeaders=function(){var e=this.getStackTop();if(e.scope&&e.client){var t=e.scope.getSpan();if(t)return{"sentry-trace":t.toTraceparent()}}return{}},e}();function $(){var e=m();return e.__SENTRY__=e.__SENTRY__||{hub:void 0},e}function Y(e){var t=$(),n=Q(t);return Z(t,e),n}function K(){var e,t,n=$();X(n)&&!Q(n).isOlderThan(G)||Z(n,new z);try{var r=(e=module,t="domain",e.require(t)).active;if(!r)return Q(n);if(!X(r)||Q(r).isOlderThan(G)){var o=Q(n).getStackTop();Z(r,new z(o.client,V.clone(o.scope)))}return Q(r)}catch(e){return Q(n)}}function X(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function Q(e){return e&&e.__SENTRY__&&e.__SENTRY__.hub?e.__SENTRY__.hub:(e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.hub=new z,e.__SENTRY__.hub)}function Z(e,t){return!!e&&(e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.hub=t,!0)}function ee(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=K();if(r&&r[e])return r[e].apply(r,u(t));throw new Error("No hub defined or "+e+" was not found on the hub, please open a bug report.")}function te(e){var t;try{throw new Error("Sentry syntheticException")}catch(e){t=e}return ee("captureException",e,{originalException:e,syntheticException:t})}function ne(e){ee("withScope",e)}var re=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w\.-]+)(?::(\d+))?\/(.+)/,oe=function(){function e(e){"string"==typeof e?this.K(e):this.Z(e),this.Y()}return e.prototype.toString=function(e){void 0===e&&(e=!1);var t=this,n=t.host,r=t.path,o=t.pass,i=t.port,s=t.projectId;return t.protocol+"://"+t.user+(e&&o?":"+o:"")+"@"+n+(i?":"+i:"")+"/"+(r?r+"/":r)+s},e.prototype.K=function(e){var t=re.exec(e);if(!t)throw new l("Invalid Dsn");var n=a(t.slice(1),6),r=n[0],o=n[1],i=n[2],s=void 0===i?"":i,u=n[3],c=n[4],p=void 0===c?"":c,d="",f=n[5],h=f.split("/");h.length>1&&(d=h.slice(0,-1).join("/"),f=h.pop()),Object.assign(this,{host:u,pass:s,path:d,projectId:f,port:p,protocol:r,user:o})},e.prototype.Z=function(e){this.protocol=e.protocol,this.user=e.user,this.pass=e.pass||"",this.host=e.host,this.port=e.port||"",this.path=e.path||"",this.projectId=e.projectId},e.prototype.Y=function(){var e=this;if(["protocol","user","host","projectId"].forEach(function(t){if(!e[t])throw new l("Invalid Dsn")}),"http"!==this.protocol&&"https"!==this.protocol)throw new l("Invalid Dsn");if(this.port&&Number.isNaN(parseInt(this.port,10)))throw new l("Invalid Dsn")},e}(),ie=function(){function e(e){this.dsn=e,this.nn=new oe(e)}return e.prototype.getDsn=function(){return this.nn},e.prototype.getStoreEndpoint=function(){return""+this.tn()+this.getStoreEndpointPath()},e.prototype.getStoreEndpointWithUrlEncodedAuth=function(){var e,t={sentry_key:this.nn.user,sentry_version:"7"};return this.getStoreEndpoint()+"?"+(e=t,Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&"))},e.prototype.tn=function(){var e=this.nn,t=e.protocol?e.protocol+":":"",n=e.port?":"+e.port:"";return t+"//"+e.host+n},e.prototype.getStoreEndpointPath=function(){var e=this.nn;return(e.path?"/"+e.path:"")+"/api/"+e.projectId+"/store/"},e.prototype.getRequestHeaders=function(e,t){var n=this.nn,r=["Sentry sentry_version=7"];return r.push("sentry_timestamp="+(new Date).getTime()),r.push("sentry_client="+e+"/"+t),r.push("sentry_key="+n.user),n.pass&&r.push("sentry_secret="+n.pass),{"Content-Type":"application/json","X-Sentry-Auth":r.join(", ")}},e.prototype.getReportDialogEndpoint=function(e){void 0===e&&(e={});var t=this.nn,n=this.tn()+(t.path?"/"+t.path:"")+"/api/embed/error-page/",r=[];for(var o in r.push("dsn="+t.toString()),e)if("user"===o){if(!e.user)continue;e.user.name&&r.push("name="+encodeURIComponent(e.user.name)),e.user.email&&r.push("email="+encodeURIComponent(e.user.email))}else r.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return r.length?n+"?"+r.join("&"):n},e}(),se=[];var ae,ue=function(){function e(e,t){this.rn=!1,this.en=new e(t),this.in=t,t.dsn&&(this.on=new oe(t.dsn)),this.un=function(e){var t={};return function(e){var t=e.defaultIntegrations&&u(e.defaultIntegrations)||[],n=e.integrations,r=[];if(Array.isArray(n)){var o=n.map(function(e){return e.name}),i=[];t.forEach(function(e){-1===o.indexOf(e.name)&&-1===i.indexOf(e.name)&&(r.push(e),i.push(e.name))}),n.forEach(function(e){-1===i.indexOf(e.name)&&(r.push(e),i.push(e.name))})}else{if("function"!=typeof n)return u(t);r=n(t),r=Array.isArray(r)?r:[r]}return r}(e).forEach(function(e){t[e.name]=e,function(e){-1===se.indexOf(e.name)&&(e.setupOnce(H,K),se.push(e.name),R.log("Integration installed: "+e.name))}(e)}),t}(this.in)}return e.prototype.captureException=function(e,t,n){var r=this,o=t&&t.event_id;return this.rn=!0,this.cn().eventFromException(e,t).then(function(e){return r.sn(e,t,n)}).then(function(e){o=e&&e.event_id,r.rn=!1}).catch(function(e){R.error(e),r.rn=!1}),o},e.prototype.captureMessage=function(e,t,n,r){var o=this,i=n&&n.event_id;return this.rn=!0,(g(e)?this.cn().eventFromMessage(""+e,t,n):this.cn().eventFromException(e,n)).then(function(e){return o.sn(e,n,r)}).then(function(e){i=e&&e.event_id,o.rn=!1}).catch(function(e){R.error(e),o.rn=!1}),i},e.prototype.captureEvent=function(e,t,n){var r=this,o=t&&t.event_id;return this.rn=!0,this.sn(e,t,n).then(function(e){o=e&&e.event_id,r.rn=!1}).catch(function(e){R.error(e),r.rn=!1}),o},e.prototype.getDsn=function(){return this.on},e.prototype.getOptions=function(){return this.in},e.prototype.flush=function(e){var t=this;return this.an(e).then(function(n){return clearInterval(n.interval),t.cn().getTransport().close(e).then(function(e){return n.ready&&e})})},e.prototype.close=function(e){var t=this;return this.flush(e).then(function(e){return t.getOptions().enabled=!1,e})},e.prototype.getIntegrations=function(){return this.un||{}},e.prototype.getIntegration=function(e){try{return this.un[e.id]||null}catch(t){return R.warn("Cannot retrieve integration "+e.id+" from the current Client"),null}},e.prototype.an=function(e){var t=this;return new Promise(function(n){var r=0,o=0;clearInterval(o),o=setInterval(function(){t.rn?e&&(r+=1)>=e&&n({interval:o,ready:!1}):n({interval:o,ready:!0})},1)})},e.prototype.cn=function(){return this.en},e.prototype.fn=function(){return!1!==this.getOptions().enabled&&void 0!==this.on},e.prototype.hn=function(e,t,n){var r=this.getOptions(),o=r.environment,i=r.release,a=r.dist,u=r.maxValueLength,c=void 0===u?250:u,l=s({},e);void 0===l.environment&&void 0!==o&&(l.environment=o),void 0===l.release&&void 0!==i&&(l.release=i),void 0===l.dist&&void 0!==a&&(l.dist=a),l.message&&(l.message=N(l.message,c));var p=l.exception&&l.exception.values&&l.exception.values[0];p&&p.value&&(p.value=N(p.value,c));var d=l.request;d&&d.url&&(d.url=N(d.url,c)),void 0===l.event_id&&(l.event_id=S()),this.ln(l.sdk);var f=F.resolve(l);return t&&(f=t.applyToEvent(l,n)),f},e.prototype.ln=function(e){var t=Object.keys(this.un);e&&t.length>0&&(e.integrations=t)},e.prototype.sn=function(e,t,n){var r=this,o=this.getOptions(),i=o.beforeSend,s=o.sampleRate;return this.fn()?"number"==typeof s&&Math.random()>s?F.reject("This event has been sampled, will not send event."):new F(function(o,s){r.hn(e,n,t).then(function(e){if(null!==e){var n=e;try{if(t&&t.data&&!0===t.data.__sentry__||!i)return r.cn().sendEvent(n),void o(n);var a=i(e,t);if(void 0===a)R.error("`beforeSend` method has to return `null` or a valid event.");else if(_(a))r.vn(a,o,s);else{if(null===(n=a))return R.log("`beforeSend` returned `null`, will not send event."),void o(null);r.cn().sendEvent(n),o(n)}}catch(e){r.captureException(e,{data:{__sentry__:!0},originalException:e}),s("`beforeSend` throw an error, will not send event.")}}else s("An event processor returned null, will not send event.")})}):F.reject("SDK not enabled, will not send event.")},e.prototype.vn=function(e,t,n){var r=this;e.then(function(e){null!==e?(r.cn().sendEvent(e),t(e)):n("`beforeSend` returned `null`, will not send event.")}).catch(function(e){n("beforeSend rejected with "+e)})},e}(),ce=function(){function t(){}return t.prototype.sendEvent=function(t){return Promise.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:e.Status.Skipped})},t.prototype.close=function(e){return Promise.resolve(!0)},t}(),le=function(){function e(e){this.in=e,this.in.dsn||R.warn("No DSN provided, backend will not do anything."),this.dn=this.pn()}return e.prototype.pn=function(){return new ce},e.prototype.eventFromException=function(e,t){throw new l("Backend has to implement `eventFromException` method")},e.prototype.eventFromMessage=function(e,t,n){throw new l("Backend has to implement `eventFromMessage` method")},e.prototype.sendEvent=function(e){this.dn.sendEvent(e).catch(function(e){R.error("Error while sending event: "+e)})},e.prototype.getTransport=function(){return this.dn},e}(),pe=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){ae=Function.prototype.toString,Function.prototype.toString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.__sentry__?this.__sentry_original__:this;return ae.apply(n,e)}},e.id="FunctionToString",e}(),de=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],fe=function(){function e(t){void 0===t&&(t={}),this.in=t,this.name=e.id}return e.prototype.setupOnce=function(){H(function(t){var n=K();if(!n)return t;var r=n.getIntegration(e);if(r){var o=n.getClient(),i=o?o.getOptions():{},s=r.mn(i);if(r.yn(t,s))return null}return t})},e.prototype.yn=function(e,t){return this.bn(e,t)?(R.warn("Event dropped due to being internal Sentry Error.\nEvent: "+w(e)),!0):this.wn(e,t)?(R.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+w(e)),!0):this.gn(e,t)?(R.warn("Event dropped due to being matched by `blacklistUrls` option.\nEvent: "+w(e)+".\nUrl: "+this.En(e)),!0):!this.xn(e,t)&&(R.warn("Event dropped due to not being matched by `whitelistUrls` option.\nEvent: "+w(e)+".\nUrl: "+this.En(e)),!0)},e.prototype.bn=function(e,t){if(void 0===t&&(t={}),!t.ignoreInternal)return!1;try{return"SentryError"===e.exception.values[0].type}catch(e){return!1}},e.prototype.wn=function(e,t){return void 0===t&&(t={}),!(!t.ignoreErrors||!t.ignoreErrors.length)&&this.jn(e).some(function(e){return t.ignoreErrors.some(function(t){return W(e,t)})})},e.prototype.gn=function(e,t){if(void 0===t&&(t={}),!t.blacklistUrls||!t.blacklistUrls.length)return!1;var n=this.En(e);return!!n&&t.blacklistUrls.some(function(e){return W(n,e)})},e.prototype.xn=function(e,t){if(void 0===t&&(t={}),!t.whitelistUrls||!t.whitelistUrls.length)return!0;var n=this.En(e);return!n||t.whitelistUrls.some(function(e){return W(n,e)})},e.prototype.mn=function(e){return void 0===e&&(e={}),{blacklistUrls:u(this.in.blacklistUrls||[],e.blacklistUrls||[]),ignoreErrors:u(this.in.ignoreErrors||[],e.ignoreErrors||[],de),ignoreInternal:void 0===this.in.ignoreInternal||this.in.ignoreInternal,whitelistUrls:u(this.in.whitelistUrls||[],e.whitelistUrls||[])}},e.prototype.jn=function(e){if(e.message)return[e.message];if(e.exception)try{var t=e.exception.values[0],n=t.type,r=t.value;return[""+r,n+": "+r]}catch(t){return R.error("Cannot extract message for event "+w(e)),[]}return[]},e.prototype.En=function(e){try{if(e.stacktrace){var t=e.stacktrace.frames;return t[t.length-1].filename}if(e.exception){var n=e.exception.values[0].stacktrace.frames;return n[n.length-1].filename}return null}catch(t){return R.error("Cannot extract url for event "+w(e)),null}},e.id="InboundFilters",e}(),he=Object.freeze({FunctionToString:pe,InboundFilters:fe}),ge=m(),ve={_n:!1,Sn:!1,On:!1,kn:!1},_e="?",ye=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function me(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Se(){return"undefined"==typeof document||null==document.location?"":document.location.href}ve._n=function(){var e,t,n=[],r=null,o=null;function i(e,t,r){var o=null;if(!t||ve.Sn){for(var i in n)if(me(n,i))try{n[i](e,t,r)}catch(e){o=e}if(o)throw o}}function a(t,n,r,a,u){var l=null;if(u=d(u)?u.error:u,t=d(t)?t.message:t,o)ve.On.Tn(o,n,r,t),c();else if(u&&p(u))(l=ve.On(u)).mechanism="onerror",i(l,!0,u);else{var f,h={url:n,line:r,column:a},g=t;if("[object String]"==={}.toString.call(t)){var v=t.match(ye);v&&(f=v[1],g=v[2])}h.func=_e,h.context=null,i(l={name:f,message:g,mode:"onerror",mechanism:"onerror",stack:[s({},h,{url:h.url||Se()})]},!0,null)}return!!e&&e.apply(this,arguments)}function u(e){var t=e&&(e.detail?e.detail.reason:e.reason)||e,n=ve.On(t);n.mechanism="onunhandledrejection",n.message||(n.message=JSON.stringify(U(t))),i(n,!0,t)}function c(){var e=o,t=r;o=null,r=null,i(e,!1,t)}function l(e){if(o){if(r===e)return;c()}var t=ve.On(e);throw o=t,r=e,setTimeout(function(){r===e&&c()},t.incomplete?2e3:0),e}return l.Rn=function(e){n.push(e)},l.Dn=function(){!0!==t&&(e=ge.onerror,ge.onerror=a,t=!0)},l.In=function(){ge.onunhandledrejection=u},l}(),ve.On=function(){function e(e){if(!e||!e.stack)return null;for(var t,n,r,o=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,i=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js))(?::(\d+))?(?::(\d+))?\s*$/i,s=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,a=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,u=/\((\S*)(?::(\d+))(?::(\d+))\)/,c=e.stack.split("\n"),l=[],p=/^(.*) is undefined$/.exec(e.message),d=0,f=c.length;d<f;++d){if(n=o.exec(c[d])){var h=n[2]&&0===n[2].indexOf("native");n[2]&&0===n[2].indexOf("eval")&&(t=u.exec(n[2]))&&(n[2]=t[1],n[3]=t[2],n[4]=t[3]),r={url:n[2],func:n[1]||_e,args:h?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=s.exec(c[d]))r={url:n[2],func:n[1]||_e,args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=i.exec(c[d])))continue;n[3]&&n[3].indexOf(" > eval")>-1&&(t=a.exec(n[3]))?(n[1]=n[1]||"eval",n[3]=t[1],n[4]=t[2],n[5]=""):0!==d||n[5]||void 0===e.columnNumber||(l[0].column=e.columnNumber+1),r={url:n[3],func:n[1]||_e,args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}!r.func&&r.line&&(r.func=_e),r.context=null,l.push(r)}return l.length?(l[0]&&l[0].line&&!l[0].column&&p&&(l[0].column=null),{mode:"stack",name:e.name,message:e.message,stack:l}):null}function t(e,t,n,r){var o={url:t,line:n};if(o.url&&o.line){if(e.incomplete=!1,o.func||(o.func=_e),o.context||(o.context=null),/ '([^']+)' /.exec(r)&&(o.column=null),e.stack.length>0&&e.stack[0].url===o.url){if(e.stack[0].line===o.line)return!1;if(!e.stack[0].line&&e.stack[0].func===o.func)return e.stack[0].line=o.line,e.stack[0].context=o.context,!1}return e.stack.unshift(o),e.partial=!0,!0}return e.incomplete=!0,!1}function n(e,r){for(var o,i,s=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,a=[],u={},c=!1,l=n.caller;l&&!c;l=l.caller)if(l!==Ee&&l!==ve._n){if(i={url:null,func:_e,args:[],line:null,column:null},l.name?i.func=l.name:(o=s.exec(l.toString()))&&(i.func=o[1]),void 0===i.func)try{i.func=o.input.substring(0,o.input.indexOf("{"))}catch(e){}u[""+l]?c=!0:u[""+l]=!0,a.push(i)}r&&a.splice(0,r);var p={mode:"callers",name:e.name,message:e.message,stack:a};return t(p,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),p}function r(t,r){var o=null;r=null==r?0:+r;try{if(o=function(e){var t=e.stacktrace;if(t){for(var n,r=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,o=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,i=t.split("\n"),s=[],a=0;a<i.length;a+=2){var u=null;(n=r.exec(i[a]))?u={url:n[2],line:+n[1],column:null,func:n[3],args:[]}:(n=o.exec(i[a]))&&(u={url:n[6],line:+n[1],column:+n[2],func:n[3]||n[4],args:n[5]?n[5].split(","):[]}),u&&(!u.func&&u.line&&(u.func=_e),u.line&&(u.context=null),u.context||(u.context=[i[a+1]]),s.push(u))}return s.length?{mode:"stacktrace",name:e.name,message:e.message,stack:s}:null}}(t))return o}catch(e){}try{if(o=e(t))return o}catch(e){}try{if(o=function(e){var t=e.message.split("\n");if(t.length<4)return null;var n,r=/^\s*Line (\d+) of linked script ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,o=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,i=/^\s*Line (\d+) of function script\s*$/i,s=[],a=ge&&ge.document&&ge.document.getElementsByTagName("script"),u=[];for(var c in a)me(a,c)&&!a[c].src&&u.push(a[c]);for(var l=2;l<t.length;l+=2){var p=null;(n=r.exec(t[l]))?p={url:n[2],func:n[3],args:[],line:+n[1],column:null}:(n=o.exec(t[l]))?p={url:n[3],func:n[4],args:[],line:+n[1],column:null}:(n=i.exec(t[l]))&&(p={url:Se().replace(/#.*$/,""),func:"",args:[],line:n[1],column:null}),p&&(p.func||(p.func=_e),p.context=[t[l+1]],s.push(p))}return s.length?{mode:"multiline",name:e.name,message:t[0],stack:s}:null}(t))return o}catch(e){}try{if(o=n(t,r+1))return o}catch(e){}return{original:t,name:t.name,message:t.message,mode:"failed"}}return r.Tn=t,r.Cn=e,r}(),ve.Sn=!0,ve.kn=11;var be=ve._n.Rn,we=ve._n.Dn,ke=ve._n.In,Ee=ve.On,Te=50;function Le(e){var t=Re(e.stack),n={type:e.name,value:e.message};return t&&t.length&&(n.stacktrace={frames:t}),void 0===n.type&&""===n.value&&(n.value="Unrecoverable error caught"),n}function xe(e){return{exception:{values:[Le(e)]}}}function Re(e){if(!e||!e.length)return[];var t=e,n=t[0].func||"",r=t[t.length-1].func||"";return(n.includes("captureMessage")||n.includes("captureException"))&&(t=t.slice(1)),r.includes("sentryWrapped")&&(t=t.slice(0,-1)),t.map(function(e){return{colno:e.column,filename:e.url||t[0].url,function:e.func||"?",in_app:!0,lineno:e.line}}).slice(0,Te).reverse()}var Ie,Oe,Pe=function(){function e(e){this.options=e,this.h=new M(30),this.url=new ie(this.options.dsn).getStoreEndpointWithUrlEncodedAuth()}return e.prototype.sendEvent=function(e){throw new l("Transport Class has to implement `sendEvent` method")},e.prototype.close=function(e){return this.h.drain(e)},e}(),Ce=m(),Ue=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return n(r,t),r.prototype.sendEvent=function(t){var n={body:JSON.stringify(t),method:"POST",referrerPolicy:function(){if(!D())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(e){return!1}}()?"origin":""};return this.h.add(Ce.fetch(this.url,n).then(function(t){return{status:e.Status.fromHttpCode(t.status)}}))},r}(Pe),je=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return n(r,t),r.prototype.sendEvent=function(t){var n=this;return this.h.add(new Promise(function(r,o){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status&&r({status:e.Status.fromHttpCode(i.status)}),o(i))},i.open("POST",n.url),i.send(JSON.stringify(t))}))},r}(Pe),Me=Object.freeze({BaseTransport:Pe,FetchTransport:Ue,XHRTransport:je}),Ne=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return n(r,t),r.prototype.pn=function(){if(!this.in.dsn)return t.prototype.pn.call(this);var e=s({},this.in.transportOptions,{dsn:this.in.dsn});return this.in.transport?new this.in.transport(e):D()?new Ue(e):new je(e)},r.prototype.eventFromException=function(t,n){var r,o,i=this;if(d(t)&&t.error)return t=t.error,r=xe(Ee(t)),F.resolve(this.Nn(r,n));if(f(t)||(o=t,"[object DOMException]"===Object.prototype.toString.call(o))){var s=t,a=s.name||(f(s)?"DOMError":"DOMException"),u=s.message?a+": "+s.message:a;return this.eventFromMessage(u,e.Severity.Error,n).then(function(e){return E(e,u),F.resolve(i.Nn(e,n))})}if(p(t))return r=xe(Ee(t)),F.resolve(this.Nn(r,n));if(v(t)&&n&&n.syntheticException)return E(r=function(e,t){var n=Object.keys(e).sort(),r={extra:{__serialized__:P(e)},message:"Non-Error exception captured with keys: "+function(e,t){if(void 0===t&&(t=40),!e.length)return"[object has no keys]";if(e[0].length>=t)return N(e[0],t);for(var n=e.length;n>0;n--){var r=e.slice(0,n).join(", ");if(!(r.length>t))return n===e.length?r:N(r,t)}return""}(n)};if(t){var o=Re(Ee(t).stack);r.stacktrace={frames:o}}return r}(t,n.syntheticException),"Custom Object",void 0,{handled:!0,synthetic:!0,type:"generic"}),r.level=e.Severity.Error,F.resolve(this.Nn(r,n));var c=t;return this.eventFromMessage(c,void 0,n).then(function(t){return E(t,""+c,void 0,{handled:!0,synthetic:!0,type:"generic"}),t.level=e.Severity.Error,F.resolve(i.Nn(t,n))})},r.prototype.Nn=function(e,t){return s({},e,{event_id:t&&t.event_id})},r.prototype.eventFromMessage=function(t,n,r){void 0===n&&(n=e.Severity.Info);var o={event_id:r&&r.event_id,level:n,message:t};if(this.in.attachStacktrace&&r&&r.syntheticException){var i=Re(Ee(r.syntheticException).stack);o.stacktrace={frames:i}}return F.resolve(o)},r}(le),Ae="sentry.javascript.browser",We=function(e){function t(t){return void 0===t&&(t={}),e.call(this,Ne,t)||this}return n(t,e),t.prototype.hn=function(t,n,r){return t.platform=t.platform||"javascript",t.sdk=s({},t.sdk,{name:Ae,packages:u(t.sdk&&t.sdk.packages||[],[{name:"npm:@sentry/browser",version:"5.5.0"}]),version:"5.5.0"}),e.prototype.hn.call(this,t,n,r)},t.prototype.showReportDialog=function(e){void 0===e&&(e={});var t=m().document;if(t)if(this.fn()){var n=e.dsn||this.getDsn();if(e.eventId)if(n){var r=t.createElement("script");r.async=!0,r.src=new ie(n).getReportDialogEndpoint(e),e.onLoad&&(r.onload=e.onLoad),(t.head||t.body).appendChild(r)}else R.error("Missing `Dsn` option in showReportDialog call");else R.error("Missing `eventId` option in showReportDialog call")}else R.error("Trying to call showReportDialog with Sentry Client is disabled")},t}(ue),De=1e3,Fe=0;function qe(e,t,n){if(void 0===t&&(t={}),"function"!=typeof e)return e;try{if(e.__sentry__)return e;if(e.__sentry_wrapped__)return e.__sentry_wrapped__}catch(t){return e}var r=function(){n&&"function"==typeof n&&n.apply(this,arguments);var r=Array.prototype.slice.call(arguments);try{var o=r.map(function(e){return qe(e,t)});return e.handleEvent?e.handleEvent.apply(this,o):e.apply(this,o)}catch(e){throw Fe+=1,setTimeout(function(){Fe-=1}),ne(function(n){n.addEventProcessor(function(e){var n=s({},e);return t.mechanism&&E(n,void 0,void 0,t.mechanism),n.extra=s({},n.extra,{arguments:U(r,3)}),n}),te(e)}),e}};try{for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}catch(e){}e.prototype=e.prototype||{},r.prototype=e.prototype,Object.defineProperty(e,"__sentry_wrapped__",{enumerable:!1,value:r}),Object.defineProperties(r,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:e}});try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:function(){return e.name}})}catch(e){}return r}var Be=0;function Ve(e,t){return void 0===t&&(t=!1),function(n){if(Ie=void 0,n&&Oe!==n){Oe=n;var r=function(){var t;try{t=n.target?He(n.target):He(n)}catch(e){t="<unknown>"}0!==t.length&&K().addBreadcrumb({category:"ui."+e,message:t},{event:n,name:e})};Be&&clearTimeout(Be),t?Be=setTimeout(r):r()}}}function Je(){return function(e){var t;try{t=e.target}catch(e){return}var n=t&&t.tagName;n&&("INPUT"===n||"TEXTAREA"===n||t.isContentEditable)&&(Ie||Ve("input")(e),clearTimeout(Ie),Ie=setTimeout(function(){Ie=void 0},De))}}function He(e){for(var t,n=e,r=[],o=0,i=0,s=" > ".length;n&&o++<5&&!("html"===(t=Ge(n))||o>1&&i+r.length*s+t.length>=80);)r.push(t),i+=t.length,n=n.parentNode;return r.reverse().join(" > ")}function Ge(e){var t,n,r,o,i,s=[];if(!e||!e.tagName)return"";if(s.push(e.tagName.toLowerCase()),e.id&&s.push("#"+e.id),(t=e.className)&&h(t))for(n=t.split(/\s+/),i=0;i<n.length;i++)s.push("."+n[i]);var a=["type","name","title","alt"];for(i=0;i<a.length;i++)r=a[i],(o=e.getAttribute(r))&&s.push("["+r+'="'+o+'"]');return s.join("")}var ze=function(){function e(t){this.name=e.id,this.in=s({onerror:!0,onunhandledrejection:!0},t)}return e.prototype.setupOnce=function(){Error.stackTraceLimit=50,be(function(t,n,r){if(!(Fe>0)){var o=K().getIntegration(e);o&&K().captureEvent(o.An(t),{data:{stack:t},originalException:r})}}),this.in.onerror&&(R.log("Global Handler attached: onerror"),we()),this.in.onunhandledrejection&&(R.log("Global Handler attached: onunhandledrejection"),ke())},e.prototype.An=function(e){if(!h(e.message)&&"onunhandledrejection"!==e.mechanism){var t=e.message;e.message=t.error&&h(t.error.message)?t.error.message:"No error message"}var n=xe(e),r={mode:e.mode};e.message&&(r.message=e.message),e.name&&(r.name=e.name);var o=K().getClient(),i=o&&o.getOptions().maxValueLength||250;return E(n,e.original?N(JSON.stringify(U(e.original)),i):"","onunhandledrejection"===e.mechanism?"UnhandledRejection":"Error",{data:r,handled:!1,type:e.mechanism}),n},e.id="GlobalHandlers",e}(),$e=function(){function e(){this.Ln=0,this.name=e.id}return e.prototype.Mn=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t[0];return t[0]=qe(r,{mechanism:{data:{function:Ye(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}},e.prototype.Un=function(e){return function(t){return e(qe(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Ye(e)},handled:!0,type:"instrument"}}))}},e.prototype.Fn=function(e){var t=m(),n=t[e]&&t[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(O(n,"addEventListener",function(t){return function(n,r,o){try{"function"==typeof r.handleEvent&&(r.handleEvent=qe(r.handleEvent.bind(r),{mechanism:{data:{function:"handleEvent",handler:Ye(r),target:e},handled:!0,type:"instrument"}}))}catch(e){}return t.call(this,n,qe(r,{mechanism:{data:{function:"addEventListener",handler:Ye(r),target:e},handled:!0,type:"instrument"}}),o)}}),O(n,"removeEventListener",function(e){return function(t,n,r){var o=n;try{o=o&&(o.__sentry_wrapped__||o)}catch(e){}return e.call(this,t,o,r)}}))},e.prototype.setupOnce=function(){this.Ln=this.Ln;var e=m();O(e,"setTimeout",this.Mn.bind(this)),O(e,"setInterval",this.Mn.bind(this)),O(e,"requestAnimationFrame",this.Un.bind(this)),["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this.Fn.bind(this))},e.id="TryCatch",e}();function Ye(e){try{return e&&e.name||"<anonymous>"}catch(e){return"<anonymous>"}}var Ke,Xe=m(),Qe=function(){function t(e){this.name=t.id,this.in=s({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},e)}return t.prototype.Pn=function(){"console"in Xe&&["debug","info","warn","error","log","assert"].forEach(function(n){n in Xe.console&&O(Xe.console,n,function(r){return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var s={category:"console",data:{extra:{arguments:U(o,3)},logger:"console"},level:e.Severity.fromString(n),message:A(o," ")};"assert"===n&&!1===o[0]&&(s.message="Assertion failed: "+(A(o.slice(1)," ")||"console.assert"),s.data.extra.arguments=U(o.slice(1),3)),t.addBreadcrumb(s,{input:o,level:n}),r&&Function.prototype.apply.call(r,Xe.console,o)}})})},t.prototype.$n=function(){"document"in Xe&&(Xe.document.addEventListener("click",Ve("click"),!1),Xe.document.addEventListener("keypress",Je(),!1),["EventTarget","Node"].forEach(function(e){var t=Xe[e]&&Xe[e].prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(O(t,"addEventListener",function(e){return function(t,n,r){return n&&n.handleEvent?("click"===t&&O(n,"handleEvent",function(e){return function(t){return Ve("click")(t),e.call(this,t)}}),"keypress"===t&&O(n,"handleEvent",function(e){return function(t){return Je()(t),e.call(this,t)}})):("click"===t&&Ve("click",!0)(this),"keypress"===t&&Je()(this)),e.call(this,t,n,r)}}),O(t,"removeEventListener",function(e){return function(t,n,r){var o=n;try{o=o&&(o.__sentry_wrapped__||o)}catch(e){}return e.call(this,t,o,r)}}))}))},t.prototype.qn=function(){(function(){if(!D())return!1;var e=function(e){return-1!==e.toString().indexOf("native")},t=m(),n=null,r=t.document;if(r){var o=r.createElement("iframe");o.hidden=!0;try{r.head.appendChild(o),o.contentWindow&&o.contentWindow.fetch&&(n=e(o.contentWindow.fetch)),r.head.removeChild(o)}catch(e){R.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}}return null===n&&(n=e(t.fetch)),n})()&&O(Xe,"fetch",function(n){return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i,s=r[0],a="GET";"string"==typeof s?i=s:"Request"in Xe&&s instanceof Request?(i=s.url,s.method&&(a=s.method)):i=String(s),r[1]&&r[1].method&&(a=r[1].method);var u=K().getClient(),c=u&&u.getDsn();if(c){var l=new ie(c).getStoreEndpoint();if(l&&i.includes(l))return"POST"===a&&r[1]&&r[1].body&&Ze(r[1].body),n.apply(Xe,r)}var p={method:a,url:i};return n.apply(Xe,r).then(function(e){return p.status_code=e.status,t.addBreadcrumb({category:"fetch",data:p,type:"http"},{input:r,response:e}),e}).catch(function(n){throw t.addBreadcrumb({category:"fetch",data:p,level:e.Severity.Error,type:"http"},{error:n,input:r}),n})}})},t.prototype.Hn=function(){var e=this;if(o=(r=(n=m()).chrome)&&r.app&&r.app.runtime,i="history"in n&&!!n.history.pushState&&!!n.history.replaceState,!o&&i){var n,r,o,i,s=function(e,n){var r=b(Xe.location.href),o=b(n),i=b(e);i.path||(i=r),Ke=n,r.protocol===o.protocol&&r.host===o.host&&(n=o.relative),r.protocol===i.protocol&&r.host===i.host&&(e=i.relative),t.addBreadcrumb({category:"navigation",data:{from:e,to:n}})},a=Xe.onpopstate;Xe.onpopstate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Xe.location.href;if(s(Ke,r),a)return a.apply(e,t)},O(Xe.history,"pushState",u),O(Xe.history,"replaceState",u)}function u(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.length>2?t[2]:void 0;return r&&s(Ke,String(r)),e.apply(this,t)}}},t.prototype.Wn=function(){if("XMLHttpRequest"in Xe){var e=XMLHttpRequest.prototype;O(e,"open",function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t[1];this.__sentry_xhr__={method:t[0],url:t[1]};var o=K().getClient(),i=o&&o.getDsn();if(i){var s=new ie(i).getStoreEndpoint();h(r)&&s&&r.includes(s)&&(this.__sentry_own_request__=!0)}return e.apply(this,t)}}),O(e,"send",function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=this;function i(){if(4===o.readyState){if(o.__sentry_own_request__)return;try{o.__sentry_xhr__&&(o.__sentry_xhr__.status_code=o.status)}catch(e){}t.addBreadcrumb({category:"xhr",data:o.__sentry_xhr__,type:"http"},{xhr:o})}}return o.__sentry_own_request__&&Ze(n[0]),["onload","onerror","onprogress"].forEach(function(e){!function(e,t){e in t&&"function"==typeof t[e]&&O(t,e,function(t){return qe(t,{mechanism:{data:{function:e,handler:t&&t.name||"<anonymous>"},handled:!0,type:"instrument"}})})}(e,o)}),"onreadystatechange"in o&&"function"==typeof o.onreadystatechange?O(o,"onreadystatechange",function(e){return qe(e,{mechanism:{data:{function:"onreadystatechange",handler:e&&e.name||"<anonymous>"},handled:!0,type:"instrument"}},i)}):o.onreadystatechange=i,e.apply(this,n)}})}},t.addBreadcrumb=function(e,n){K().getIntegration(t)&&K().addBreadcrumb(e,n)},t.prototype.setupOnce=function(){this.in.console&&this.Pn(),this.in.dom&&this.$n(),this.in.xhr&&this.Wn(),this.in.fetch&&this.qn(),this.in.history&&this.Hn()},t.id="Breadcrumbs",t}();function Ze(t){try{var n=JSON.parse(t);Qe.addBreadcrumb({category:"sentry",event_id:n.event_id,level:n.level||e.Severity.fromString("error"),message:w(n)},{event:n})}catch(e){R.error("Error while adding sentry type breadcrumb")}}var et="cause",tt=5,nt=function(){function e(t){void 0===t&&(t={}),this.name=e.id,this.Bn=t.key||et,this.s=t.limit||tt}return e.prototype.setupOnce=function(){H(function(t,n){var r=K().getIntegration(e);return r?r.Jn(t,n):t})},e.prototype.Jn=function(e,t){if(!(e.exception&&e.exception.values&&t&&t.originalException instanceof Error))return e;var n=this.Xn(t.originalException,this.Bn);return e.exception.values=u(n,e.exception.values),e},e.prototype.Xn=function(e,t,n){if(void 0===n&&(n=[]),!(e[t]instanceof Error)||n.length+1>=this.s)return n;var r=Le(Ee(e[t]));return this.Xn(e[t],t,u([r],n))},e.id="LinkedErrors",e}(),rt=m(),ot=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){H(function(t){if(K().getIntegration(e)){if(!rt.navigator||!rt.location)return t;var n=t.request||{};return n.url=n.url||rt.location.href,n.headers=n.headers||{},n.headers["User-Agent"]=rt.navigator.userAgent,s({},t,{request:n})}return t})},e.id="UserAgent",e}(),it=Object.freeze({GlobalHandlers:ze,TryCatch:$e,Breadcrumbs:Qe,LinkedErrors:nt,UserAgent:ot}),st=[new fe,new pe,new $e,new Qe,new ze,new nt,new ot],at={},ut=m();ut.Sentry&&ut.Sentry.Integrations&&(at=ut.Sentry.Integrations);var ct=s({},at,he,it);return e.BrowserClient=We,e.Hub=z,e.Integrations=ct,e.SDK_NAME=Ae,e.SDK_VERSION="5.5.0",e.Scope=V,e.Span=B,e.Transports=Me,e.addBreadcrumb=function(e){ee("addBreadcrumb",e)},e.addGlobalEventProcessor=H,e.captureEvent=function(e){return ee("captureEvent",e)},e.captureException=te,e.captureMessage=function(e,t){var n;try{throw new Error(e)}catch(e){n=e}return ee("captureMessage",e,t,{originalException:e,syntheticException:n})},e.close=function(e){var t=K().getClient();return t?t.close(e):Promise.reject(!1)},e.configureScope=function(e){ee("configureScope",e)},e.defaultIntegrations=st,e.flush=function(e){var t=K().getClient();return t?t.flush(e):Promise.reject(!1)},e.forceLoad=function(){},e.getCurrentHub=K,e.getHubFromCarrier=Q,e.init=function(e){if(void 0===e&&(e={}),void 0===e.defaultIntegrations&&(e.defaultIntegrations=st),void 0===e.release){var t=m();t.SENTRY_RELEASE&&t.SENTRY_RELEASE.id&&(e.release=t.SENTRY_RELEASE.id)}!function(e,t){!0===t.debug&&R.enable(),K().bindClient(new e(t))}(We,e)},e.lastEventId=function(){return K().lastEventId()},e.onLoad=function(e){e()},e.setContext=function(e,t){ee("setContext",e,t)},e.setExtra=function(e,t){ee("setExtra",e,t)},e.setExtras=function(e){ee("setExtras",e)},e.setTag=function(e,t){ee("setTag",e,t)},e.setTags=function(e){ee("setTags",e)},e.setUser=function(e){ee("setUser",e)},e.showReportDialog=function(e){void 0===e&&(e={}),e.eventId||(e.eventId=K().lastEventId());var t=K().getClient();t&&t.showReportDialog(e)},e.withScope=ne,e.wrap=function(e){qe(e)()},e}({});(SW=SW||{}).Device={},SW.Device.getOS=(()=>{const e=window.navigator.userAgent,t=window.navigator.platform;let n="Unknown";return-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(t)?n="macOS":-1!==["iPhone","iPad","iPod"].indexOf(t)?n="iOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(t)?n="Windows":/Android/.test(e)&&(n="Android"),n}),SW.Device.isTablet=(()=>SW.Device.isIpad()||/Android/.test(navigator.userAgent)&&!/Mobile/.test(navigator.userAgent)),SW.Device.isIpad=(()=>null!=navigator.userAgent.match(/iPad/i)),SW.Device.isNativeApp=function(){return"1"===SW.Utility.getUrlVar("iosApp")||"1"===SW.Utility.getUrlVar("nativeApp")},(SW=SW||{}).Utility={},SW.Utility.getUrlVars=(()=>{var e={};decodeURIComponent(window.location.href).replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,n,r){e[n]=r.replace(/\+/g," ")});return e}),SW.Utility.getUrlVar=function(e){var t=SW.Utility.getUrlVars();for(var n in t)if(n==e)return t[n];return!1};
var SW = SW || {};
SW.Load = {};
var prodigyWeb = {}
  , loadingText = ["Feeding pets", "Studying spells", "Delivering mail", "Counting coins", "Rearranging furniture", "Solving for x", "Planting grass", "Burying fossils", "Darkening the tower", "Stocking shops", "Dirtying socks", "Cutting pizza", "Carving wands", "Sewing outfits", "Petting buddies", "Gathering clouds", "Heating lava", "Raking sand", "Balancing equations", "Mixing fractions", "Carrying the one", "Picking apples", "Lighting lanterns", "Going on tangents", "Pulling levers", "Planting beanstalks", "Turning on weather machines", "Waking Floatlings", "Sharpening pencils", "Memorizing times tables", "Brewing potions", "Morphing marbles", "Getting lost in archives", "Preparing questions", "Warming up dance moves", "Lighting fireworks", "Sweeping confetti", "Packing snowballs", "Baking cakes", "Chasing waterfalls", "Hiding secrets", "Rehearsing lines", "Counting verticies", "Comparing sizes"]
  , unusedText = []
  , cycleTextTimeout = null;
SW.Load.bgPath = "https://cdn.prodigygame.com/game/assets/v1_cache/single-images/login-bg-13/1/login-bg-13.png",
SW.Load.bgLoaded = !1,
SW.Load.bgShowing = !1,
SW.Load.sendLoadStart = function() {
    SW.LoadIdentity.setupEventParams();
    const e = `${SW.LoadIdentity.getServiceURL()}events-api/v3/anonymous-events`;
    window.loadStartTime = Date.now(),
    SW.LoadIdentity.sendV3Event(e, {
        type: "login_screen_funnel",
        name: "load_start",
        timeDelta: 0
    })
}
,
SW.Load.sendLoginEnd = function() {
    const e = `${SW.LoadIdentity.getServiceURL()}events-api/v3/anonymous-events`
      , n = SW.Storage.get(SW.LoadIdentity.STORAGE_START_EVENT_TS)
      , t = {
        type: "login_time_funnel",
        name: "load_end",
        timeDelta: Date.now() - n
    };
    SW.LoadIdentity.sendV3Event(e, t)
}
,
SW.Load.getUrlVars = function() {
    var e = {};
    decodeURIComponent(window.location.href).replace(/[?&]+([^=&]+)=([^&]*)/gi, function(n, t, i) {
        e[t] = i.replace(/\+/g, " ")
    });
    return e
}
,
SW.Load.getUrlVar = function(e) {
    var n = SW.Load.getUrlVars();
    for (var t in n)
        if (t == e)
            return n[t]
}
,
SW.Load.loadGameBundles = function() {
    SW.Load.cycleLoadingText(),
    SW.LoadGameBundle.initialize()
}
,
SW.Load.getWebURL = function() {
    return prodigyWebUrl
}
;
var _request = function(e, n, t, i, a, o, d) {
    void 0 === a && (a = 3),
    o || (o = "json"),
    d || (d = "GET");
    const s = new XMLHttpRequest;
    s.onreadystatechange = function() {
        if (s.readyState === XMLHttpRequest.DONE)
            if (200 === this.status) {
                var r = s.response.data;
                n && n(r)
            } else
                a > 0 ? _request(e, n, t, i, --a, o, d) : (console.log("_request failed"),
                SW.LoadIdentity.setErrorScreen(`${t}: Too many requests. Gave up`, void 0, void 0, i))
    }
    ,
    s.responseType = o,
    s.open(d, e, !0),
    s.send("")
};
SW.Load.getGameStatus = function() {
    const e = `${SW.LoadIdentity.getServiceURL()}game-api/status`;
    _request(e, function(e) {
        var n = e
          , t = SW.Load.getUrlVar("feature") || ""
          , i = SW.Load.getUrlVar("release") || ""
          , a = "undefined" != typeof prodigyGameCodePath ? prodigyGameCodePath : n.gameCodePath;
        window.gameApiStatusData = n,
        t && (a = (a = a.replace("dev", "feature/" + t)).replace("staging", "feature/" + t)),
        i && (a = a.replace(/production(.*)/, "production/" + i + "/"));
        var o = a + "game.min.js?v=" + n.gameClientVersion;
        "undefined" != typeof prodigyGameCodeFile && (o = -1 === prodigyGameCodeFile.indexOf("/") ? a + prodigyGameCodeFile + "?v=" + n.gameClientVersion : prodigyGameCodeFile),
        window.gameCodeFile = o,
        "undefined" != typeof prodigyGameDataVersion && prodigyGameDataVersion && (window.gameApiStatusData.prodigyGameFlags.gameDataVersion = prodigyGameDataVersion);
        var d = document.createElement("link");
        d.relList && d.relList.supports("preload") && (d.href = o,
        d.rel = "preload",
        d.as = "script",
        document.head.appendChild(d)),
        window.waitingOnResponse && (SW.Load.loadGameBundles(),
        window.waitingOnResponse = !1)
    }, "Game Status", 10)
}
,
SW.Load.getEducationStatus = function() {
    const e = `${SW.LoadIdentity.getServiceURL()}education-api/v1/frontend-paths`;
    _request(e, function(e) {
        var n, t, i = e;
        "iOS" !== SW.Device.getOS() && "Android" !== SW.Device.getOS() && !SW.Device.isNativeApp() || SW.Device.isTablet() ? (n = _.find(i, {
            id: "question-renderer"
        }).path,
        t = _.find(i, {
            id: "desktop-question-interface"
        }).path) : (n = _.find(i, {
            id: "mobile-question-renderer"
        }).path,
        t = _.find(i, {
            id: "mobile-question-interface"
        }).path),
        window.questionRendererURL = n,
        window.questionInterfaceURL = t
    }, "Education Status", 70)
}
,
SW.Load.loadGame = function() {
    window.onload = function() {
        document.addEventListener("contextmenu", function(e) {
            e.preventDefault()
        }, !1)
    }
    ,
    prodigyWeb.membershipFlow = {
        $el: $("#membership-flow"),
        $game: $("#game-wrapper"),
        student: {
            name: void 0,
            userID: void 0
        },
        closeCallback: void 0,
        open: function(e, n, t, i, a, o, d, s) {
            var r = function(e) {
                _.isObject(e.data) && "membership-iframe-closed" === e.data.type && (window.removeEventListener("message", r),
                this.close(e.data.success))
            }
            .bind(this);
            window.addEventListener("message", r);
            var g = SW.Load.getWebURL() + "Membership?game=1&tag=" + i + "&username=" + e + "&id=" + n + "&funnelName=" + a + "&isPlayingFromHome=" + o + "&metaData=" + d + "&token=" + s
              , c = $('<iframe src="' + g + '">');
            this.student.name = e,
            this.student.userID = n,
            this.closeCallback = t,
            this.$el.show().append(c),
            this.$game.hide()
        },
        close: function(e) {
            this.$el.hide().html(""),
            this.$game.show(),
            window.postMessage(JSON.stringify({
                name: "membership-flow-closed",
                success: e
            }), "*"),
            _.isUndefined(this.closeCallback) || this.closeCallback(e)
        }
    },
    window.gameApiStatusData ? SW.Load.loadGameBundles() : window.waitingOnResponse = !0
}
,
SW.Load.getDeviceInformationFromAPI = function() {
    if (SW.Storage.get(SW.LoadIdentity.STORAGE_DEVICE_INFO))
        return;
    const e = new XMLHttpRequest;
    var n = SW.LoadIdentity.getServiceURL() + "device-detect-api/v1/information?";
    n = n + "user_agent=" + navigator.userAgent,
    "undefined" != typeof DeviceAtlas && (n = n + "&properties=" + encodeURIComponent(DeviceAtlas.getPropertiesAsString())),
    e.onreadystatechange = function() {
        if (e.readyState === XMLHttpRequest.DONE && 200 === this.status) {
            const n = e.response;
            n && n.model && SW.Storage.set(SW.LoadIdentity.STORAGE_DEVICE_INFO, e.response)
        }
    }
    ,
    e.responseType = "json",
    e.open("GET", n, !0),
    e.send("")
}
,
SW.Load.setLoadingVisible = function(e) {
    SW.LoadIdentity.setDivDisplay(SW.LoadIdentity.DIV_GAME_LOADING_CONTAINER, e)
}
,
SW.Load.cycleLoadingText = function() {
    var e = 3500;
    if (0 === unusedText.length)
        unusedText = [...loadingText],
        document.getElementById("loading-text").innerHTML = "Loading game",
        e = 1e3;
    else {
        var n = Math.floor(Math.random() * unusedText.length)
          , t = unusedText[n];
        unusedText.splice(n, 1),
        $(".game-loading__font").fadeOut(500, ()=>{
            $(".game-loading__font").fadeIn(500),
            document.getElementById("loading-text").innerHTML = t
        }
        )
    }
    window.clearTimeout(cycleTextTimeout),
    cycleTextTimeout = window.setTimeout(SW.Load.cycleLoadingText, e)
}
,
SW.Load.getSplashImage = function() {
    var e = new Image;
    e.onload = function() {
        SW.Load.bgLoaded = !0,
        SW.Load.showSplashScreen()
    }
    ,
    e.src = SW.Load.bgPath
}
,
SW.Load.showSplashScreen = function() {
    var e = document.getElementById(SW.LoadIdentity.DIV_SPLASH_IMAGE);
    if (e) {
        var n = e.style;
        SW.LoadIdentity.isErrorScreen() || (n.display = ""),
        n.backgroundImage = `url(${SW.Load.bgPath})`,
        SW.Load.bgShowing = !0
    } else
        console.log("Warning: Splash screen div not found")
}
,
SW.Load.checkPendingSplashScreen = function() {
    return !(SW.Load.bgShowing || !SW.Load.bgLoaded) && (SW.Load.showSplashScreen(),
    !0)
}
,
SW.Load.getTrackingCookie = function() {
    return SW.Cookie.getTrackingCookie()
}
,
SW.Load.IdentityCheck = function(e) {
    SW.LoadIdentity.isErrorScreen() && console.log("Do not IdentityCheck because error screen is displaying.");
    var n = new Oidc.UserManager({
        userStore: new Oidc.WebStorageStateStore(settings),
        clockSkew: e,
        loadUserInfo: !0
    });
    n.signinRedirectCallback().then(function(e) {
        !async function(e) {
            const n = await e.getUser();
            n ? (window.userInfo = {
                accessToken: n.access_token,
                uuid: n.profile.sub,
                email: n.profile.email,
                name: n.profile.name,
                sid: n.profile.sid
            },
            window.addEventListener("beforeunload", ()=>{
                SW.LoadIdentity.Logout()
            }
            )) : (console.log("Check for user failed. Signin redirect"),
            e.signinRedirect().catch(e=>{
                SW.LoadIdentity.setErrorScreen(`User signin redirect failed: ${e}`, SW.LoadIdentity.ERROR_TITLE_IDENTITY_REDIRECT_FAILED, SW.LoadIdentity.ERROR_DESCRIPTION_IDENTITY_REDIRECT_FAILED, 30),
                console.error(e)
            }
            ))
        }(n)
    }).catch(function(e) {
        console.log(`signin redirect callback failure: ${e}`),
        SW.LoadIdentity.setErrorScreen(`Identity redirect callback failed: ${e}`, SW.LoadIdentity.ERROR_TITLE_IDENTITY_CALLBACK_FAILED, SW.LoadIdentity.ERROR_DESCRIPTION_IDENTITY_CALLBACK_FAILED, 20)
    })
}
;
